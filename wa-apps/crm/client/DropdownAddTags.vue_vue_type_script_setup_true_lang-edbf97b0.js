import{d as k,J as C,h as v,l as T,R as b,o,i as u,w as h,c as i,p as f,j as d,u as c,A as F,F as g,q as S,al as x,a as m,e as A}from"./main-f4d713e0.js";import{C as B}from"./CustomColumn-97fca79e.js";import{C as L,a as I}from"./ChipsList-110d0801.js";import{F as D}from"./FieldCheckbox-24639e50.js";const E={key:0,class:"hint"},K={key:1},M=m("div",{class:"spinner"},null,-1),$=[M],j=["onClick"],q={key:0},z=m("i",{class:"fas fa-spinner tw-animate-spin"},null,-1),J=[z],N={class:"tw-flex-auto tw-truncate"},O=k({__name:"DropdownAddTags",props:{modelValue:{},entityType:{},entityIds:{}},emits:["update:modelValue","input"],setup(V,{emit:_}){const a=V,l=C();l.refetch();const n=v(""),r=v(new Set),p=T(()=>l.tags.filter(e=>!("tags"in a.modelValue?a.modelValue.tags:a.modelValue).map(s=>typeof s=="string"?s:s.name).includes(e.name)).sort((e,s)=>s.count-e.count).slice(0,10));b(n,e=>{_("input",e)});function w(e){y(n.value),n.value="",e.target.blur()}async function y(e){Array.isArray(a.modelValue)?_("update:modelValue",[...a.modelValue,e]):(r.value.add(e),await l.tagAssign(a.entityType,a.entityIds,[e]).execute(),r.value.delete(e))}return(e,s)=>(o(),u(B,{space:"2"},{default:h(()=>[p.value.length>0?(o(),i("div",E,f(e.$t("popularTags")),1)):d("",!0),c(l).isFetching?(o(),i("div",K,$)):c(l).error?(o(),i(g,{key:2},[F(f(c(l).error),1)],64)):p.value.length>0?(o(),u(L,{key:3},{default:h(()=>[(o(!0),i(g,null,S(p.value,t=>(o(),u(I,{key:t.id+String(t.color),color:t.color,"bg-color":t.bg_color,class:"smaller"},{default:h(()=>[m("a",{onClick:A(()=>{!r.value.has(t.name)&&y(t.name)},["prevent"])},[r.value.has(t.name)?(o(),i("span",q,J)):d("",!0),m("span",N,f(t.name),1)],8,j)]),_:2},1032,["color","bg-color"]))),128))]),_:1})):d("",!0),c(l).isFetching?d("",!0):(o(),u(D,{key:4,modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=t=>n.value=t),modelModifiers:{trim:!0},disabled:r.value.size,type:"text",placeholder:e.$t("createNewTag"),onKeyup:s[1]||(s[1]=x(t=>{n.value.length&&w(t)},["enter"]))},null,8,["modelValue","disabled","placeholder"]))]),_:1}))}});export{O as _};

!function(o){(console="undefined"==typeof console?void 0!==window.console?window.console:{}:console).log=console.log||function(){},console.debug=console.debug||console.log,console.warn=console.warn||console.log,console.error=console.error||function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);alert(t.join("\n"))},console.trace=console.trace||console.log,console.group=console.group||console.log,console.groupEnd=console.groupEnd||console.log,console.profile=console.profile||console.log,console.profileEnd=console.profileEnd||console.log,o.History={options:{debug:!1},state:"",$window:null,$iframe:null,handlers:{generic:[],specific:{}},format:function(t){return t=t.replace(/^.+?#/g,"").replace(/^#?\/?|\/?$/g,"")},getState:function(){return o.History.state},setState:function(t){var e=o.History;return t=e.format(t),e.state=t,e.state},getHash:function(){var t,e=o.History;return t=parent&&!o.browser.msie?parent.window.location.hash:window.location.hash||location.hash,t=e.format(t)},setHash:function(t){o.History;t=(t=o.History.format(t)).replace(/^\/?|\/?(\?)|\/?$/g,"/$1"),void 0===window.location.hash&&(location.hash=t),o.browser.msie&&parseInt(o.browser.version,10)<8&&(o.History.$iframe.contentWindow.document.open(),o.History.$iframe.contentWindow.document.close())},go:function(t){var e=o.History;return t=e.format(t),e.getHash()!==t?e.setHash(t):(e.setState(t),e.trigger()),!0},hashchange:function(t){var e=o.History,i=(e.options.debug&&console.debug("History.hashchange",this,arguments),e.getHash()),n=e.getState();return!(!e.$iframe&&n===i||e.$iframe&&e.hash===e.$iframe.contentWindow.document.location.hash||n===i||(e.setState(i),e.trigger(),0))},bind:function(t,e){var i=o.History;return e?(void 0===i.handlers.specific[t]&&(i.handlers.specific[t]=[]),i.handlers.specific[t].push(e)):i.handlers.generic.push(e=t),!0},trigger:function(t){var e,i,n,s=o.History;if(void 0===t&&(t=s.getState()),void 0!==s.handlers.specific[t])for(e=0,i=(n=s.handlers.specific[t]).length;e<i;++e)(0,n[e])(t);for(e=0,i=(n=s.handlers.generic).length;e<i;++e)(0,n[e])(t);return!0},construct:function(){var t=o.History;return o(document).ready(function(){t.domReady()}),!0},configure:function(t){var e=o.History;return e.options=o.extend(e.options,t),!0},domReadied:!1,domReady:function(){var t=o.History;if(!t.domRedied)return t.domRedied=!0,t.$window=o(window),t.$window.bind("hashchange",this.hashchange),setTimeout(t.hashchangeLoader,200),!0},hashchangeLoader:function(){var t,e=o.History;return o.browser.msie&&8<=parseInt(o.browser.version)?(t=e.getHash())&&e.$window.trigger("hashchange"):(t=o.browser.msie?(e.$iframe=o('<iframe id="jquery-history-iframe" style="display: none;"></$iframe>').prependTo(document.body)[0],e.$iframe.contentWindow.document.open(),e.$iframe.contentWindow.document.close(),(t=e.getHash())&&(e.$iframe.contentWindow.document.location.hash=t),function(){var t=e.format(e.$iframe.contentWindow.document.location.hash),t=(e.getState()!==t&&e.setHash(e.$iframe.contentWindow.document.location.hash),e.getHash());e.getState()!==t&&e.go(t)}):function(){var t=e.getHash();e.getState()!==t&&e.go(t)},o.browser.msie&&parseInt(o.browser.version)<8?setInterval(t,1500):setInterval(t,200)),!0}},o.History.construct()}(jQuery),function(n,i){n.store=function(t,e){var i=this;if("string"==typeof t){if(!n.store.drivers[t])throw new Error("Unknown driver "+t);this.driver=n.store.drivers[t]}else if("object"==typeof t){if(!(n.isFunction(t.init)&&n.isFunction(t.get)&&n.isFunction(t.set)&&n.isFunction(t.del)&&n.isFunction(t.flush)))throw new Error("The specified driver does not fulfill the API requirements");this.driver=t}else n.each(n.store.drivers,function(){return!n.isFunction(this.available)||!this.available()||(i.driver=this,!1===i.driver.init()&&!(i.driver=null))});e=e||n.store.serializers,this.serializers={},n.each(e,function(t,e){if(!n.isFunction(this.init))return!0;i.serializers[t]=this,i.serializers[t].init(i.encoders,i.decoders)})},n.extend(n.store.prototype,{get:function(t){t=this.driver.get(t);return this.driver.encodes?t:this.unserialize(t)},set:function(t,e){this.driver.set(t,this.driver.encodes?e:this.serialize(e))},del:function(t){this.driver.del(t)},flush:function(){this.driver.flush()},driver:i,encoders:[],decoders:[],serialize:function(e){var i=this;return n.each(this.encoders,function(){var t=i.serializers[this+""];if(!t||!t.encode)return!0;try{e=t.encode(e)}catch(t){}}),e},unserialize:function(e){var i=this;return e&&n.each(this.decoders,function(){var t=i.serializers[this+""];if(!t||!t.decode)return!0;e=t.decode(e)}),e}}),n.store.drivers={localStorage:{ident:"$.store.drivers.localStorage",scope:"browser",available:function(){try{return!!window.localStorage}catch(t){return!1}},init:n.noop,get:function(t){return window.localStorage.getItem(t)},set:function(t,e){window.localStorage.setItem(t,e)},del:function(t){window.localStorage.removeItem(t)},flush:function(){window.localStorage.clear()}},userData:{ident:"$.store.drivers.userData",element:null,nodeName:"userdatadriver",scope:"browser",initialized:!1,available:function(){try{return!(!document.documentElement||!document.documentElement.addBehavior)}catch(t){return!1}},init:function(){if(!this.initialized)try{this.element=document.createElement(this.nodeName),document.documentElement.insertBefore(this.element,document.getElementsByTagName("title")[0]),this.element.addBehavior("#default#userData"),this.initialized=!0}catch(t){return!1}},get:function(t){return this.element.load(this.nodeName),this.element.getAttribute(t)},set:function(t,e){this.element.setAttribute(t,e),this.element.save(this.nodeName)},del:function(t){this.element.removeAttribute(t),this.element.save(this.nodeName)},flush:function(){this.element.expires=(new Date).toUTCString(),this.element.save(this.nodeName)}},windowName:{ident:"$.store.drivers.windowName",scope:"window",cache:{},encodes:!0,available:function(){return!0},init:function(){this.load()},save:function(){window.name=n.store.serializers.json.encode(this.cache)},load:function(){try{this.cache=n.store.serializers.json.decode(window.name+""),"object"!=typeof this.cache&&(this.cache={})}catch(t){this.cache={},window.name="{}"}},get:function(t){return this.cache[t]},set:function(t,e){this.cache[t]=e,this.save()},del:function(e){try{delete this.cache[e]}catch(t){this.cache[e]=i}this.save()},flush:function(){window.name="{}"}}},n.store.serializers={json:{ident:"$.store.serializers.json",init:function(t,e){t.push("json"),e.push("json")},encode:("object"==typeof JSON?JSON:n.JSON).stringify,decode:("object"==typeof JSON?JSON:n.JSON).parse},xml:{ident:"$.store.serializers.xml",init:function(t,e){t.unshift("xml"),e.push("xml")},isXML:function(t){t=(t?t.ownerDocument||t:0).documentElement;return!!t&&"html"!==t.nodeName.toLowerCase()},encode:function(e){if(e&&!e._serialized&&this.isXML(e)){var i={_serialized:this.ident,value:e};try{return i.value=(new XMLSerializer).serializeToString(e),i}catch(t){try{return i.value=e.xml,i}catch(t){}}}return e},decode:function(t){var e;return t&&t._serialized&&t._serialized==this.ident?(e=!(e="DOMParser"in window&&(new DOMParser).parseFromString)&&window.ActiveXObject?function(t){var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}:e)&&(t.value=e.call("DOMParser"in window&&new DOMParser||window,t.value,"text/xml"),this.isXML(t.value))?t.value:i:t}}}}(jQuery),function(r){function n(t,e){var i,n,s,o=t.nodeName.toLowerCase();return"area"===o?(n=(i=t.parentNode).name,!(!t.href||!n||"map"!==i.nodeName.toLowerCase()||!(s=r("img[usemap=#"+n+"]")[0]))&&a(s)):(/input|select|textarea|button|object/.test(o)?!t.disabled:"a"==o&&t.href||e)&&a(t)}function a(t){return!r(t).parents().andSelf().filter(function(){return"hidden"===r.curCSS(this,"visibility")||r.expr.filters.hidden(this)}).length}r.ui=r.ui||{},r.ui.version||(r.extend(r.ui,{version:"1.8.24",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),r.fn.extend({propAttr:r.fn.prop||r.fn.attr,_focus:r.fn.focus,focus:function(e,i){return"number"==typeof e?this.each(function(){var t=this;setTimeout(function(){r(t).focus(),i&&i.call(t)},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var t=(r.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(r.curCSS(this,"position",1))&&/(auto|scroll)/.test(r.curCSS(this,"overflow",1)+r.curCSS(this,"overflow-y",1)+r.curCSS(this,"overflow-x",1))}):this.parents().filter(function(){return/(auto|scroll)/.test(r.curCSS(this,"overflow",1)+r.curCSS(this,"overflow-y",1)+r.curCSS(this,"overflow-x",1))})).eq(0);return/fixed/.test(this.css("position"))||!t.length?r(document):t},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var e,i=r(this[0]);i.length&&i[0]!==document;){if(("absolute"===(e=i.css("position"))||"relative"===e||"fixed"===e)&&(e=parseInt(i.css("zIndex"),10),!isNaN(e))&&0!==e)return e;i=i.parent()}return 0},disableSelection:function(){return this.bind((r.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),r("<a>").outerWidth(1).jquery||r.each(["Width","Height"],function(t,i){function n(t,e,i,n){return r.each(s,function(){e-=parseFloat(r.curCSS(t,"padding"+this,!0))||0,i&&(e-=parseFloat(r.curCSS(t,"border"+this+"Width",!0))||0),n&&(e-=parseFloat(r.curCSS(t,"margin"+this,!0))||0)}),e}var s="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:r.fn.innerWidth,innerHeight:r.fn.innerHeight,outerWidth:r.fn.outerWidth,outerHeight:r.fn.outerHeight};r.fn["inner"+i]=function(t){return void 0===t?a["inner"+i].call(this):this.each(function(){r(this).css(o,n(this,t)+"px")})},r.fn["outer"+i]=function(t,e){return"number"!=typeof t?a["outer"+i].call(this,t):this.each(function(){r(this).css(o,n(this,t,!0,e)+"px")})}}),r.extend(r.expr[":"],{data:r.expr.createPseudo?r.expr.createPseudo(function(e){return function(t){return!!r.data(t,e)}}):function(t,e,i){return!!r.data(t,i[3])},focusable:function(t){return n(t,!isNaN(r.attr(t,"tabindex")))},tabbable:function(t){var e=r.attr(t,"tabindex"),i=isNaN(e);return(i||0<=e)&&n(t,!i)}}),r(function(){var t=document.body,e=t.appendChild(document.createElement("div"));e.offsetHeight,r.extend(e.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),r.support.minHeight=100===e.offsetHeight,r.support.selectstart="onselectstart"in e,t.removeChild(e).style.display="none"}),r.curCSS||(r.curCSS=r.css),r.extend(r.ui,{plugin:{add:function(t,e,i){var n,s=r.ui[t].prototype;for(n in i)s.plugins[n]=s.plugins[n]||[],s.plugins[n].push([e,i[n]])},call:function(t,e,i){var n=t.plugins[e];if(n&&t.element[0].parentNode)for(var s=0;s<n.length;s++)t.options[n[s][0]]&&n[s][1].apply(t.element,i)}},contains:function(t,e){return document.compareDocumentPosition?16&t.compareDocumentPosition(e):t!==e&&t.contains(e)},hasScroll:function(t,e){var i;return"hidden"!==r(t).css("overflow")&&(i=!1,0<t[e=e&&"left"===e?"scrollLeft":"scrollTop"]||(t[e]=1,i=0<t[e],t[e]=0,i))},isOverAxis:function(t,e,i){return e<t&&t<e+i},isOver:function(t,e,i,n,s,o){return r.ui.isOverAxis(t,i,s)&&r.ui.isOverAxis(e,n,o)}}))}(jQuery),function(a){var n,i;a.cleanData?(n=a.cleanData,a.cleanData=function(t){for(var e,i=0;null!=(e=t[i]);i++)try{a(e).triggerHandler("remove")}catch(t){}n(t)}):(i=a.fn.remove,a.fn.remove=function(t,e){return this.each(function(){return e||(t&&!a.filter(t,[this]).length||a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(t){}})),i.call(a(this),t,e)})}),a.widget=function(e,t,i){var n,s=e.split(".")[0],t=(n=s+"-"+(e=e.split(".")[1]),i||(i=t,t=a.Widget),a.expr[":"][n]=function(t){return!!a.data(t,e)},a[s]=a[s]||{},a[s][e]=function(t,e){arguments.length&&this._createWidget(t,e)},new t);t.options=a.extend(!0,{},t.options),a[s][e].prototype=a.extend(!0,t,{namespace:s,widgetName:e,widgetEventPrefix:a[s][e].prototype.widgetEventPrefix||e,widgetBaseClass:n},i),a.widget.bridge(e,a[s][e])},a.widget.bridge=function(o,e){a.fn[o]=function(i){var t="string"==typeof i,n=Array.prototype.slice.call(arguments,1),s=this;return i=!t&&n.length?a.extend.apply(null,[!0,i].concat(n)):i,t&&"_"===i.charAt(0)||(t?this.each(function(){var t=a.data(this,o),e=t&&a.isFunction(t[i])?t[i].apply(t,n):t;if(e!==t&&void 0!==e)return s=e,!1}):this.each(function(){var t=a.data(this,o);t?t.option(i||{})._init():a.data(this,o,new e(i,this))})),s}},a.Widget=function(t,e){arguments.length&&this._createWidget(t,e)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(t,e){a.data(e,this.widgetName,this),this.element=a(e),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),t);var i=this;this.element.bind("remove."+this.widgetName,function(){i.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(t,e){var i=t;if(0===arguments.length)return a.extend({},this.options);if("string"==typeof t){if(void 0===e)return this.options[t];(i={})[t]=e}return this._setOptions(i),this},_setOptions:function(t){var i=this;return a.each(t,function(t,e){i._setOption(t,e)}),this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&this.widget()[e?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",e),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(t,e,i){var n,s,o=this.options[t];if(i=i||{},(e=a.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],s=e.originalEvent)for(n in s)n in e||(e[n]=s[n]);return this.element.trigger(e,i),!(a.isFunction(o)&&!1===o.call(this.element[0],e,i)||e.isDefaultPrevented())}}}(jQuery),function(s){var o=!1;s(document).mouseup(function(t){o=!1}),s.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(t){if(!0===s.data(t.target,e.widgetName+".preventClickEvent"))return s.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&s(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){var e,i,n;if(!o)return this._mouseStarted&&this._mouseUp(t),i=1==(this._mouseDownEvent=t).which,n=!("string"!=typeof(e=this).options.cancel||!t.target.nodeName)&&s(t.target).closest(this.options.cancel).length,i&&!n&&this._mouseCapture(t)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?t.preventDefault():(!0===s.data(t.target,this.widgetName+".preventClickEvent")&&s.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return e._mouseMove(t)},this._mouseUpDelegate=function(t){return e._mouseUp(t)},s(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),o=!0)),!0},_mouseMove:function(t){return!s.browser.msie||9<=document.documentMode||t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return s(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target==this._mouseDownEvent.target&&s.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(t){return this.mouseDelayMet},_mouseStart:function(t){},_mouseDrag:function(t){},_mouseStop:function(t){},_mouseCapture:function(t){return!0}})}(jQuery),function(g){g.ui=g.ui||{};var i=/left|center|right/,n=/top|center|bottom/,m="center",v={},s=g.fn.position,o=g.fn.offset;g.fn.position=function(c){if(!c||!c.of)return s.apply(this,arguments);c=g.extend({},c);var h,d,t=g(c.of),e=t[0],f=(c.collision||"flip").split(" "),u=c.offset?c.offset.split(" "):[0,0],p=9===e.nodeType?(h=t.width(),d=t.height(),{top:0,left:0}):e.setTimeout?(h=t.width(),d=t.height(),{top:t.scrollTop(),left:t.scrollLeft()}):e.preventDefault?(c.at="left top",h=d=0,{top:c.of.pageY,left:c.of.pageX}):(h=t.outerWidth(),d=t.outerHeight(),t.offset());return g.each(["my","at"],function(){var t=(c[this]||"").split(" ");(t=1===t.length?i.test(t[0])?t.concat([m]):n.test(t[0])?[m].concat(t):[m,m]:t)[0]=i.test(t[0])?t[0]:m,t[1]=n.test(t[1])?t[1]:m,c[this]=t}),1===f.length&&(f[1]=f[0]),u[0]=parseInt(u[0],10)||0,1===u.length&&(u[1]=u[0]),u[1]=parseInt(u[1],10)||0,"right"===c.at[0]?p.left+=h:c.at[0]===m&&(p.left+=h/2),"bottom"===c.at[1]?p.top+=d:c.at[1]===m&&(p.top+=d/2),p.left+=u[0],p.top+=u[1],this.each(function(){var i,t=g(this),n=t.outerWidth(),s=t.outerHeight(),e=parseInt(g.curCSS(this,"marginLeft",!0))||0,o=parseInt(g.curCSS(this,"marginTop",!0))||0,a=n+e+(parseInt(g.curCSS(this,"marginRight",!0))||0),r=s+o+(parseInt(g.curCSS(this,"marginBottom",!0))||0),l=g.extend({},p);"right"===c.my[0]?l.left-=n:c.my[0]===m&&(l.left-=n/2),"bottom"===c.my[1]?l.top-=s:c.my[1]===m&&(l.top-=s/2),v.fractions||(l.left=Math.round(l.left),l.top=Math.round(l.top)),i={left:l.left-e,top:l.top-o},g.each(["left","top"],function(t,e){g.ui.position[f[t]]&&g.ui.position[f[t]][e](l,{targetWidth:h,targetHeight:d,elemWidth:n,elemHeight:s,collisionPosition:i,collisionWidth:a,collisionHeight:r,offset:u,my:c.my,at:c.at})}),g.fn.bgiframe&&t.bgiframe(),t.offset(g.extend(l,{using:c.using}))})},g.ui.position={fit:{left:function(t,e){var i=g(window),i=e.collisionPosition.left+e.collisionWidth-i.width()-i.scrollLeft();t.left=0<i?t.left-i:Math.max(t.left-e.collisionPosition.left,t.left)},top:function(t,e){var i=g(window),i=e.collisionPosition.top+e.collisionHeight-i.height()-i.scrollTop();t.top=0<i?t.top-i:Math.max(t.top-e.collisionPosition.top,t.top)}},flip:{left:function(t,e){var i,n,s,o;e.at[0]!==m&&(i=g(window),i=e.collisionPosition.left+e.collisionWidth-i.width()-i.scrollLeft(),n="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,s="left"===e.at[0]?e.targetWidth:-e.targetWidth,o=-2*e.offset[0],t.left+=e.collisionPosition.left<0||0<i?n+s+o:0)},top:function(t,e){var i,n,s,o;e.at[1]!==m&&(i=g(window),i=e.collisionPosition.top+e.collisionHeight-i.height()-i.scrollTop(),n="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,s="top"===e.at[1]?e.targetHeight:-e.targetHeight,o=-2*e.offset[1],t.top+=e.collisionPosition.top<0||0<i?n+s+o:0)}}},g.offset.setOffset||(g.offset.setOffset=function(t,e){/static/.test(g.curCSS(t,"position"))&&(t.style.position="relative");var i=g(t),n=i.offset(),s=parseInt(g.curCSS(t,"top",!0),10)||0,o=parseInt(g.curCSS(t,"left",!0),10)||0,s={top:e.top-n.top+s,left:e.left-n.left+o};"using"in e?e.using.call(t,s):i.css(s)},g.fn.offset=function(e){var t=this[0];return t&&t.ownerDocument?e?g.isFunction(e)?this.each(function(t){g(this).offset(e.call(this,t,g(this).offset()))}):this.each(function(){g.offset.setOffset(this,e)}):o.call(this):null}),g.curCSS||(g.curCSS=g.css);var t,e,a=document.getElementsByTagName("body")[0],r=document.createElement("div"),l=document.createElement(a?"div":"body"),c={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};for(e in a&&g.extend(c,{position:"absolute",left:"-1000px",top:"-1000px"}),c)l.style[e]=c[e];l.appendChild(r),(t=a||document.documentElement).insertBefore(l,t.firstChild),r.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;",r=g(r).offset(function(t,e){return e}).offset(),l.innerHTML="",t.removeChild(l),t=r.top+r.left+(a?2e3:0),v.fractions=21<t&&t<22}(jQuery),function(s){s.widget("ui.autocomplete",{options:{minLength:1,delay:300},_create:function(){var i=this,n=this.element[0].ownerDocument;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(t){var e=s.ui.keyCode;switch(t.keyCode){case e.PAGE_UP:i._move("previousPage",t);break;case e.PAGE_DOWN:i._move("nextPage",t);break;case e.UP:i._move("previous",t),t.preventDefault();break;case e.DOWN:i._move("next",t),t.preventDefault();break;case e.ENTER:case e.NUMPAD_ENTER:i.menu.active&&t.preventDefault();case e.TAB:i.menu.active&&i.menu.select(t);break;case e.ESCAPE:i.element.val(i.term),i.close(t);break;case e.LEFT:case e.RIGHT:case e.SHIFT:case e.CONTROL:case e.ALT:case e.COMMAND:case e.COMMAND_RIGHT:case e.INSERT:case e.CAPS_LOCK:case e.END:case e.HOME:break;default:clearTimeout(i.searching),i.searching=setTimeout(function(){i.search(null,t)},i.options.delay)}}).bind("focus.autocomplete",function(){i.selectedItem=null,i.previous=i.element.val()}).bind("blur.autocomplete",function(t){clearTimeout(i.searching),i.closing=setTimeout(function(){i.close(t),i._change(t)},150)}),this._initSource(),this.response=function(){return i._response.apply(i,arguments)},this.menu=s("<ul></ul>").addClass("ui-autocomplete").appendTo("body",n).mousedown(function(){setTimeout(function(){clearTimeout(i.closing)},13)}).menu({focus:function(t,e){e=e.item.data("item.autocomplete"),!1!==i._trigger("focus",null,{item:e})&&/^key/.test(t.originalEvent.type)&&i.element.val(e.value)},selected:function(t,e){e=e.item.data("item.autocomplete"),!1!==i._trigger("select",t,{item:e})&&i.element.val(e.value),i.close(t),t=i.previous,i.element[0]!==n.activeElement&&(i.element.focus(),i.previous=t),i.selectedItem=e},blur:function(){i.menu.element.is(":visible")&&i.element.val(i.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu"),s.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"),this.menu.element.remove(),s.Widget.prototype.destroy.call(this)},_setOption:function(t){s.Widget.prototype._setOption.apply(this,arguments),"source"===t&&this._initSource()},_initSource:function(){var i,n;s.isArray(this.options.source)?(i=this.options.source,this.source=function(t,e){e(s.ui.autocomplete.filter(i,t.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,e){s.getJSON(n,t,e)}):this.source=this.options.source},search:function(t,e){return(t=null!=t?t:this.element.val()).length<this.options.minLength?this.close(e):(clearTimeout(this.closing),!1!==this._trigger("search")?this._search(t):void 0)},_search:function(t){this.term=this.element.addClass("ui-autocomplete-loading").val(),this.source({term:t},this.response)},_response:function(t){t.length?(t=this._normalize(t),this._suggest(t),this._trigger("open")):this.close(),this.element.removeClass("ui-autocomplete-loading")},close:function(t){clearTimeout(this.closing),this.menu.element.is(":visible")&&(this._trigger("close",t),this.menu.element.hide(),this.menu.deactivate())},_change:function(t){this.previous!==this.element.val()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:s.map(t,function(t){return"string"==typeof t?{label:t,value:t}:s.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var e,i=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(i,t),this.menu.deactivate(),this.menu.refresh(),this.menu.element.show().position({my:"left top",at:"left bottom",of:this.element,collision:"flip"}),t=i.width("").width(),e=this.element.width(),i.width(Math.max(t,e))},_renderMenu:function(i,t){var n=this;s.each(t,function(t,e){n._renderItem(i,e)})},_renderItem:function(t,e){return s("<li></li>").data("item.autocomplete",e).append("<a>"+e.label+"</a>").appendTo(t)},_move:function(t,e){this.menu.element.is(":visible")?this.menu.first()&&/^previous/.test(t)||this.menu.last()&&/^next/.test(t)?(this.element.val(this.term),this.menu.deactivate()):this.menu[t](e):this.search(null,e)},widget:function(){return this.menu.element}}),s.extend(s.ui.autocomplete,{escapeRegex:function(t){return t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},filter:function(t,e){var i=new RegExp(s.ui.autocomplete.escapeRegex(e),"i");return s.grep(t,function(t){return i.test(t.label||t.value||t)})}})}(jQuery),function(s){s.widget("ui.menu",{_create:function(){var e=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(t){s(t.target).closest(".ui-menu-item a").length&&(t.preventDefault(),e.select(t))}),this.refresh()},refresh:function(){var e=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(t){e.activate(t,s(this).parent())}).mouseleave(function(){e.deactivate()})},activate:function(t,e){var i,n,s;this.deactivate(),this.hasScroll()&&(i=e.offset().top-this.element.offset().top,n=this.element.attr("scrollTop"),s=this.element.height(),i<0?this.element.attr("scrollTop",n+i):s<i&&this.element.attr("scrollTop",n+i-s+e.height())),this.active=e.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end(),this._trigger("focus",t,{item:e})},deactivate:function(){this.active&&(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null)},next:function(t){this.move("next",".ui-menu-item:first",t)},previous:function(t){this.move("prev",".ui-menu-item:last",t)},first:function(){return this.active&&!this.active.prev().length},last:function(){return this.active&&!this.active.next().length},move:function(t,e,i){this.active&&(t=this.active[t+"All"](".ui-menu-item").eq(0)).length?this.activate(i,t):this.activate(i,this.element.children(e))},nextPage:function(t){var e,i,n;this.hasScroll()?!this.active||this.last()?this.activate(t,this.element.children(":first")):(e=this.active.offset().top,i=this.element.height(),(n=this.element.children("li").filter(function(){var t=s(this).offset().top-e-i+s(this).height();return t<10&&-10<t})).length||(n=this.element.children(":last")),this.activate(t,n)):this.activate(t,this.element.children(!this.active||this.last()?":first":":last"))},previousPage:function(t){var e,i;this.hasScroll()?!this.active||this.first()?this.activate(t,this.element.children(":last")):(e=this.active.offset().top,i=this.element.height(),(result=this.element.children("li").filter(function(){var t=s(this).offset().top-e+i-s(this).height();return t<10&&-10<t})).length||(result=this.element.children(":first")),this.activate(t,result)):this.activate(t,this.element.children(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(t){this._trigger("selected",t,{item:this.active})}})}(jQuery),function(b){b.widget("ui.draggable",b.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"!=this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(t){var e=this.options;return!(this.helper||e.disabled||b(t.target).is(".ui-resizable-handle")||(this.handle=this._getHandle(t),!this.handle))},_mouseStart:function(t){var e=this.options;return this.helper=this._createHelper(t),this._cacheHelperProportions(),b.ui.ddmanager&&(b.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},b.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),e.containment&&this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),b.ui.ddmanager&&!e.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,t),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(t,!0),!0)},_mouseDrag:function(t,e){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!e){if(e=this._uiHash(),!1===this._trigger("drag",t,e))return this._mouseUp({}),!1;this.position=e.position}return this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px"),b.ui.ddmanager&&b.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var e,i=!1;return b.ui.ddmanager&&!this.options.dropBehaviour&&(i=b.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),this.element[0]&&this.element[0].parentNode&&("invalid"==this.options.revert&&!i||"valid"==this.options.revert&&i||!0===this.options.revert||b.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?b((e=this).helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==e._trigger("stop",t)&&e._clear()}):!1!==this._trigger("stop",t)&&this._clear()),!1},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var e=!this.options.handle||!b(this.options.handle,this.element).length;return b(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(e=!0)}),e},_createHelper:function(t){var e=this.options;return(t=b.isFunction(e.helper)?b(e.helper.apply(this.element[0],[t])):"clone"==e.helper?this.element.clone():this.element).parents("body").length||t.appendTo("parent"==e.appendTo?this.element[0].parentNode:e.appendTo),t[0]==this.element[0]||/(fixed|absolute)/.test(t.css("position"))||t.css("position","absolute"),t},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),"left"in(t=b.isArray(t)?{left:+t[0],top:+t[1]||0}:t)&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),{top:(t=this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&b.browser.msie?{top:0,left:0}:t).top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){var t;return"relative"==this.cssPosition?{top:(t=this.element.position()).top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}:{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i=this.options;"parent"==i.containment&&(i.containment=this.helper[0].parentNode),"document"!=i.containment&&"window"!=i.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,b("document"==i.containment?document:window).width()-this.helperProportions.width-this.margins.left,(b("document"==i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||i.containment.constructor==Array?i.containment.constructor==Array&&(this.containment=i.containment):(t=b(i.containment)[0])&&(i=b(i.containment).offset(),e="hidden"!=b(t).css("overflow"),this.containment=[i.left+(parseInt(b(t).css("borderLeftWidth"),10)||0)+(parseInt(b(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(b(t).css("borderTopWidth"),10)||0)+(parseInt(b(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(e?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(b(t).css("borderLeftWidth"),10)||0)-(parseInt(b(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(e?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(b(t).css("borderTopWidth"),10)||0)-(parseInt(b(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,e){e=e||this.position,t="absolute"==t?1:-1;var i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,n=/(html|body)/i.test(i[0].tagName);return{top:e.top+this.offset.relative.top*t+this.offset.parent.top*t-(b.browser.safari&&b.browser.version<526&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():n?0:i.scrollTop())*t),left:e.left+this.offset.relative.left*t+this.offset.parent.left*t-(b.browser.safari&&b.browser.version<526&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():n?0:i.scrollLeft())*t)}},_generatePosition:function(t){var e=this.options,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,n=/(html|body)/i.test(i[0].tagName),s=t.pageX,o=t.pageY;return this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3])&&(o=this.containment[3]+this.offset.click.top),e.grid)&&(o=this.originalPageY+Math.round((o-this.originalPageY)/e.grid[1])*e.grid[1],o=this.containment&&(o-this.offset.click.top<this.containment[1]||o-this.offset.click.top>this.containment[3])?o-this.offset.click.top<this.containment[1]?o+e.grid[1]:o-e.grid[1]:o,s=this.originalPageX+Math.round((s-this.originalPageX)/e.grid[0])*e.grid[0],s=this.containment&&(s-this.offset.click.left<this.containment[0]||s-this.offset.click.left>this.containment[2])?s-this.offset.click.left<this.containment[0]?s+e.grid[0]:s-e.grid[0]:s),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(b.browser.safari&&b.browser.version<526&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():n?0:i.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(b.browser.safari&&b.browser.version<526&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():n?0:i.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]==this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,e,i){return i=i||this._uiHash(),b.ui.plugin.call(this,t,[e,i]),"drag"==t&&(this.positionAbs=this._convertPositionTo("absolute")),b.Widget.prototype._trigger.call(this,t,e,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),b.extend(b.ui.draggable,{version:"1.8.2"}),b.ui.plugin.add("draggable","connectToSortable",{start:function(e,t){var i=b(this).data("draggable"),n=i.options,s=b.extend({},t,{item:i.element});i.sortables=[],b(n.connectToSortable).each(function(){var t=b.data(this,"sortable");t&&!t.options.disabled&&(i.sortables.push({instance:t,shouldRevert:t.options.revert}),t._refreshItems(),t._trigger("activate",e,s))})},stop:function(t,e){var i=b(this).data("draggable"),n=b.extend({},e,{item:i.element});b.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"==i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,n))})},drag:function(t,e){var i=b(this).data("draggable"),n=this;b.each(i.sortables,function(){this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=b(n).clone().appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return e.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),b.ui.plugin.add("draggable","cursor",{start:function(){var t=b("body"),e=b(this).data("draggable").options;t.css("cursor")&&(e._cursor=t.css("cursor")),t.css("cursor",e.cursor)},stop:function(){var t=b(this).data("draggable").options;t._cursor&&b("body").css("cursor",t._cursor)}}),b.ui.plugin.add("draggable","iframeFix",{start:function(){var t=b(this).data("draggable").options;b(!0===t.iframeFix?"iframe":t.iframeFix).each(function(){b('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(b(this).offset()).appendTo("body")})},stop:function(){b("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}}),b.ui.plugin.add("draggable","opacity",{start:function(t,e){t=b(e.helper),e=b(this).data("draggable").options,t.css("opacity")&&(e._opacity=t.css("opacity")),t.css("opacity",e.opacity)},stop:function(t,e){(t=b(this).data("draggable").options)._opacity&&b(e.helper).css("opacity",t._opacity)}}),b.ui.plugin.add("draggable","scroll",{start:function(){var t=b(this).data("draggable");t.scrollParent[0]!=document&&"HTML"!=t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var e=b(this).data("draggable"),i=e.options,n=!1;e.scrollParent[0]!=document&&"HTML"!=e.scrollParent[0].tagName?(i.axis&&"x"==i.axis||(e.overflowOffset.top+e.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?e.scrollParent[0].scrollTop=n=e.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-e.overflowOffset.top<i.scrollSensitivity&&(e.scrollParent[0].scrollTop=n=e.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"==i.axis||(e.overflowOffset.left+e.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?e.scrollParent[0].scrollLeft=n=e.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-e.overflowOffset.left<i.scrollSensitivity&&(e.scrollParent[0].scrollLeft=n=e.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"==i.axis||(t.pageY-b(document).scrollTop()<i.scrollSensitivity?n=b(document).scrollTop(b(document).scrollTop()-i.scrollSpeed):b(window).height()-(t.pageY-b(document).scrollTop())<i.scrollSensitivity&&(n=b(document).scrollTop(b(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"==i.axis||(t.pageX-b(document).scrollLeft()<i.scrollSensitivity?n=b(document).scrollLeft(b(document).scrollLeft()-i.scrollSpeed):b(window).width()-(t.pageX-b(document).scrollLeft())<i.scrollSensitivity&&(n=b(document).scrollLeft(b(document).scrollLeft()+i.scrollSpeed)))),!1!==n&&b.ui.ddmanager&&!i.dropBehaviour&&b.ui.ddmanager.prepareOffsets(e,t)}}),b.ui.plugin.add("draggable","snap",{start:function(){var i=b(this).data("draggable"),t=i.options;i.snapElements=[],b(t.snap.constructor!=String?t.snap.items||":data(draggable)":t.snap).each(function(){var t=b(this),e=t.offset();this!=i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:e.top,left:e.left})})},drag:function(t,e){for(var i=b(this).data("draggable"),n=i.options,s=n.snapTolerance,o=e.offset.left,a=o+i.helperProportions.width,r=e.offset.top,l=r+i.helperProportions.height,c=i.snapElements.length-1;0<=c;c--){var h,d,f,u,p,g=i.snapElements[c].left,m=g+i.snapElements[c].width,v=i.snapElements[c].top,_=v+i.snapElements[c].height;g-s<o&&o<m+s&&v-s<r&&r<_+s||g-s<o&&o<m+s&&v-s<l&&l<_+s||g-s<a&&a<m+s&&v-s<r&&r<_+s||g-s<a&&a<m+s&&v-s<l&&l<_+s?("inner"!=n.snapMode&&(h=Math.abs(v-l)<=s,d=Math.abs(_-r)<=s,f=Math.abs(g-a)<=s,u=Math.abs(m-o)<=s,h&&(e.position.top=i._convertPositionTo("relative",{top:v-i.helperProportions.height,left:0}).top-i.margins.top),d&&(e.position.top=i._convertPositionTo("relative",{top:_,left:0}).top-i.margins.top),f&&(e.position.left=i._convertPositionTo("relative",{top:0,left:g-i.helperProportions.width}).left-i.margins.left),u)&&(e.position.left=i._convertPositionTo("relative",{top:0,left:m}).left-i.margins.left),p=h||d||f||u,"outer"!=n.snapMode&&(h=Math.abs(v-r)<=s,d=Math.abs(_-l)<=s,f=Math.abs(g-o)<=s,u=Math.abs(m-a)<=s,h&&(e.position.top=i._convertPositionTo("relative",{top:v,left:0}).top-i.margins.top),d&&(e.position.top=i._convertPositionTo("relative",{top:_-i.helperProportions.height,left:0}).top-i.margins.top),f&&(e.position.left=i._convertPositionTo("relative",{top:0,left:g}).left-i.margins.left),u)&&(e.position.left=i._convertPositionTo("relative",{top:0,left:m-i.helperProportions.width}).left-i.margins.left),!i.snapElements[c].snapping&&(h||d||f||u||p)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,b.extend(i._uiHash(),{snapItem:i.snapElements[c].item})),i.snapElements[c].snapping=h||d||f||u||p):(i.snapElements[c].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,b.extend(i._uiHash(),{snapItem:i.snapElements[c].item})),i.snapElements[c].snapping=!1)}}}),b.ui.plugin.add("draggable","stack",{start:function(){var e,t=b(this).data("draggable").options;(t=b.makeArray(b(t.stack)).sort(function(t,e){return(parseInt(b(t).css("zIndex"),10)||0)-(parseInt(b(e).css("zIndex"),10)||0)})).length&&(e=parseInt(t[0].style.zIndex)||0,b(t).each(function(t){this.style.zIndex=e+t}),this[0].style.zIndex=e+t.length)}}),b.ui.plugin.add("draggable","zIndex",{start:function(t,e){t=b(e.helper),e=b(this).data("draggable").options,t.css("zIndex")&&(e._zIndex=t.css("zIndex")),t.css("zIndex",e.zIndex)},stop:function(t,e){(t=b(this).data("draggable").options)._zIndex&&b(e.helper).css("zIndex",t._zIndex)}})}(jQuery),function(d){d.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var t=this.options,e=t.accept;this.isover=0,this.isout=1,this.accept=d.isFunction(e)?e:function(t){return t.is(e)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},d.ui.ddmanager.droppables[t.scope]=d.ui.ddmanager.droppables[t.scope]||[],d.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var t=d.ui.ddmanager.droppables[this.options.scope],e=0;e<t.length;e++)t[e]==this&&t.splice(e,1);return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"),this},_setOption:function(t,e){"accept"==t&&(this.accept=d.isFunction(e)?e:function(t){return t.is(e)}),d.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var e=d.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),e&&this._trigger("activate",t,this.ui(e))},_deactivate:function(t){var e=d.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),e&&this._trigger("deactivate",t,this.ui(e))},_over:function(t){var e=d.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!=this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(e)))},_out:function(t){var e=d.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!=this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(e)))},_drop:function(t,e){var i,n=e||d.ui.ddmanager.current;return!(!n||(n.currentItem||n.element)[0]==this.element[0]||(i=!1,this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var t=d.data(this,"droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope==n.options.scope&&t.accept.call(t.element[0],n.currentItem||n.element)&&d.ui.intersect(n,d.extend(t,{offset:t.element.offset()}),t.options.tolerance))return!(i=!0)}),i)||!this.accept.call(this.element[0],n.currentItem||n.element))&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(n)),this.element)},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),d.extend(d.ui.droppable,{version:"1.8.2"}),d.ui.intersect=function(t,e,i){if(!e.offset)return!1;var n=(t.positionAbs||t.position.absolute).left,s=n+t.helperProportions.width,o=(t.positionAbs||t.position.absolute).top,a=o+t.helperProportions.height,r=e.offset.left,l=r+e.proportions.width,c=e.offset.top,h=c+e.proportions.height;switch(i){case"fit":return r<n&&s<l&&c<o&&a<h;case"intersect":return r<n+t.helperProportions.width/2&&s-t.helperProportions.width/2<l&&c<o+t.helperProportions.height/2&&a-t.helperProportions.height/2<h;case"pointer":return d.ui.isOver((t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,c,r,e.proportions.height,e.proportions.width);case"touch":return(c<=o&&o<=h||c<=a&&a<=h||o<c&&h<a)&&(r<=n&&n<=l||r<=s&&s<=l||n<r&&l<s);default:return!1}},d.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,e){var i=d.ui.ddmanager.droppables[t.options.scope]||[],n=e?e.type:null,s=(t.currentItem||t.element).find(":data(droppable)").andSelf(),o=0;t:for(;o<i.length;o++)if(!(i[o].options.disabled||t&&!i[o].accept.call(i[o].element[0],t.currentItem||t.element))){for(var a=0;a<s.length;a++)if(s[a]==i[o].element[0]){i[o].proportions.height=0;continue t}i[o].visible="none"!=i[o].element.css("display"),i[o].visible&&(i[o].offset=i[o].element.offset(),i[o].proportions={width:i[o].element[0].offsetWidth,height:i[o].element[0].offsetHeight},"mousedown"==n)&&i[o]._activate.call(i[o],e)}},drop:function(t,e){var i=!1;return d.each(d.ui.ddmanager.droppables[t.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&d.ui.intersect(t,this,this.options.tolerance)&&(i=i||this._drop.call(this,e)),!this.options.disabled)&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,e))}),i},drag:function(n,s){n.options.refreshPositions&&d.ui.ddmanager.prepareOffsets(n,s),d.each(d.ui.ddmanager.droppables[n.options.scope]||[],function(){var t,e,i;this.options.disabled||this.greedyChild||!this.visible||(t=(t=d.ui.intersect(n,this,this.options.tolerance))||1!=this.isover?t&&0==this.isover?"isover":null:"isout")&&(this.options.greedy&&(i=this.element.parents(":data(droppable):eq(0)")).length&&((e=d.data(i[0],"droppable")).greedyChild="isover"==t?1:0),e&&"isover"==t&&(e.isover=0,e.isout=1,e._out.call(e,s)),this[t]=1,this["isout"==t?"isover":"isout"]=0,this["isover"==t?"_over":"_out"].call(this,s),e)&&"isout"==t&&(e.isout=0,e.isover=1,e._over.call(e,s))})}}}(jQuery),function(f){f.widget("ui.sortable",f.ui.mouse,{widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===t.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display"))),this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},destroy:function(){f.Widget.prototype.destroy.call(this),this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;0<=t;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,e){"disabled"===t?(this.options[t]=e,this.widget()[e?"addClass":"removeClass"]("ui-sortable-disabled")):f.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,e){var i=this;if(this.reverting)return!1;if(this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(t);var n=null,s=this;f(t.target).parents().each(function(){if(f.data(this,i.widgetName+"-item")==s)return n=f(this),!1});if(!(n=f.data(t.target,i.widgetName+"-item")==s?f(t.target):n))return!1;if(this.options.handle&&!e){var o=!1;if(f(this.options.handle,n).find("*").andSelf().each(function(){this==t.target&&(o=!0)}),!o)return!1}return this.currentItem=n,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,e,i){var n=this.options;if((this.currentContainer=this).refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},f.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),n.containment&&this._setContainment(),n.cursor&&(f("body").css("cursor")&&(this._storedCursor=f("body").css("cursor")),f("body").css("cursor",n.cursor)),n.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",n.opacity)),n.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",n.zIndex)),this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(var s=this.containers.length-1;0<=s;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return f.ui.ddmanager&&(f.ui.ddmanager.current=this),f.ui.ddmanager&&!n.dropBehaviour&&f.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var e,i;this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(e=this.options,i=!1,this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<e.scrollSensitivity?this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop+e.scrollSpeed:t.pageY-this.overflowOffset.top<e.scrollSensitivity&&(this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop-e.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<e.scrollSensitivity?this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft+e.scrollSpeed:t.pageX-this.overflowOffset.left<e.scrollSensitivity&&(this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft-e.scrollSpeed)):(t.pageY-f(document).scrollTop()<e.scrollSensitivity?i=f(document).scrollTop(f(document).scrollTop()-e.scrollSpeed):f(window).height()-(t.pageY-f(document).scrollTop())<e.scrollSensitivity&&(i=f(document).scrollTop(f(document).scrollTop()+e.scrollSpeed)),t.pageX-f(document).scrollLeft()<e.scrollSensitivity?i=f(document).scrollLeft(f(document).scrollLeft()-e.scrollSpeed):f(window).width()-(t.pageX-f(document).scrollLeft())<e.scrollSensitivity&&(i=f(document).scrollLeft(f(document).scrollLeft()+e.scrollSpeed))),!1!==i)&&f.ui.ddmanager&&!e.dropBehaviour&&f.ui.ddmanager.prepareOffsets(this,t),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(var n=this.items.length-1;0<=n;n--){var s=this.items[n],o=s.item[0],a=this._intersectsWithPointer(s);if(a&&(s.instance===this.currentContainer&&!(o==this.currentItem[0]||this.placeholder[1==a?"next":"prev"]()[0]==o||f.ui.contains(this.placeholder[0],o)||"semi-dynamic"==this.options.type&&f.ui.contains(this.element[0],o)))){if(this.direction=1==a?"down":"up","pointer"!=this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),f.ui.ddmanager&&f.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,e){var i,n;if(t)return f.ui.ddmanager&&!this.options.dropBehaviour&&f.ui.ddmanager.drop(this,t),this.options.revert?(n=(i=this).placeholder.offset(),i.reverting=!0,f(this.helper).animate({left:n.left-this.offset.parent.left-i.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:n.top-this.offset.parent.top-i.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){i._clear(t)})):this._clear(t,e),!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;0<=t;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),f.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?f(this.domPosition.prev).after(this.currentItem):f(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},f(t).each(function(){var t=(f(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[-=_](.+)/);t&&i.push((e.key||t[1]+"[]")+"="+(e.key&&e.expression?t[1]:t[2]))}),!i.length&&e.key&&i.push(e.key+"="),i.join("&")},toArray:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e.each(function(){i.push(f(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,s=n+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,l=r+t.height,c=this.offset.click.top,h=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?r<n+c&&n+c<l&&o<e+h&&e+h<a:o<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<a&&r<n+this.helperProportions.height/2&&s-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var e="x"===this.options.axis||f.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),t="y"===this.options.axis||f.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),e=e&&t,t=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();return!!e&&(this.floating?i&&"right"==i||"down"==t?2:1:t&&("down"==t?2:1))},_intersectsWithSides:function(t){var e=f.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),t=f.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),i=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"==n&&t||"left"==n&&!t:i&&("down"==i&&e||"up"==i&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!=t&&(0<t?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!=t&&(0<t?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor==String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(t){var e=[],i=[],n=this._connectWith();if(n&&t)for(var s=n.length-1;0<=s;s--)for(var o=f(n[s]),a=o.length-1;0<=a;a--){var r=f.data(o[a],this.widgetName);r&&r!=this&&!r.options.disabled&&i.push([f.isFunction(r.options.items)?r.options.items.call(r.element):f(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r])}i.push([f.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):f(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(s=i.length-1;0<=s;s--)i[s][0].each(function(){e.push(this)});return f(e)},_removeCurrentsFromItems:function(){for(var t=this.currentItem.find(":data("+this.widgetName+"-item)"),e=0;e<this.items.length;e++)for(var i=0;i<t.length;i++)t[i]==this.items[e].item[0]&&this.items.splice(e,1)},_refreshItems:function(t){this.items=[],this.containers=[this];var e=this.items,i=[[f.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):f(this.options.items,this.element),this]],n=this._connectWith();if(n&&this.ready)for(var s=n.length-1;0<=s;s--)for(var o=f(n[s]),a=o.length-1;0<=a;a--){var r=f.data(o[a],this.widgetName);r&&r!=this&&!r.options.disabled&&(i.push([f.isFunction(r.options.items)?r.options.items.call(r.element[0],t,{item:this.currentItem}):f(r.options.items,r.element),r]),this.containers.push(r))}for(s=i.length-1;0<=s;s--)for(var l=i[s][1],c=i[s][0],a=0,h=c.length;a<h;a++){var d=f(c[a]);d.data(this.widgetName+"-item",l),e.push({item:d,instance:l,width:0,height:0,left:0,top:0})}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var e=this.items.length-1;0<=e;e--){var i,n=this.items[e];n.instance!=this.currentContainer&&this.currentContainer&&n.item[0]!=this.currentItem[0]||(i=this.options.toleranceElement?f(this.options.toleranceElement,n.item):n.item,t||(n.width=i.outerWidth(),n.height=i.outerHeight()),s=i.offset(),n.left=s.left,n.top=s.top)}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;0<=e;e--){var s=this.containers[e].element.offset();this.containers[e].containerCache.left=s.left,this.containers[e].containerCache.top=s.top,this.containers[e].containerCache.width=this.containers[e].element.outerWidth(),this.containers[e].containerCache.height=this.containers[e].element.outerHeight()}return this},_createPlaceholder:function(t){var i,n=t||this,s=n.options;s.placeholder&&s.placeholder.constructor!=String||(i=s.placeholder,s.placeholder={element:function(){var t=f(document.createElement(n.currentItem[0].nodeName)).addClass(i||n.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return i||(t.style.visibility="hidden"),t},update:function(t,e){i&&!s.forcePlaceholderSize||(e.height()||e.height(n.currentItem.innerHeight()-parseInt(n.currentItem.css("paddingTop")||0,10)-parseInt(n.currentItem.css("paddingBottom")||0,10)),e.width())||e.width(n.currentItem.innerWidth()-parseInt(n.currentItem.css("paddingLeft")||0,10)-parseInt(n.currentItem.css("paddingRight")||0,10))}}),n.placeholder=f(s.placeholder.element.call(n.element,n.currentItem)),n.currentItem.after(n.placeholder),s.placeholder.update(n,n.placeholder)},_contactContainers:function(t){for(var e=null,i=null,n=this.containers.length-1;0<=n;n--)f.ui.contains(this.currentItem[0],this.containers[n].element[0])||(this._intersectsWith(this.containers[n].containerCache)?e&&f.ui.contains(this.containers[n].element[0],e.element[0])||(e=this.containers[n],i=n):this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0));if(e)if(1===this.containers.length)this.containers[i]._trigger("over",t,this._uiHash(this)),this.containers[i].containerCache.over=1;else if(this.currentContainer!=this.containers[i]){for(var s,o=1e4,a=null,r=this.positionAbs[this.containers[i].floating?"left":"top"],l=this.items.length-1;0<=l;l--)f.ui.contains(this.containers[i].element[0],this.items[l].item[0])&&(s=this.containers[i].floating?this.items[l].item.offset().left:this.items[l].item.offset().top,Math.abs(s-r)<o)&&(o=Math.abs(s-r),a=this.items[l],this.direction=0<s-r?"down":"up");(a||this.options.dropOnEmpty)&&(this.currentContainer=this.containers[i],a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[i].element,!0),this._trigger("change",t,this._uiHash()),this.containers[i]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[i]._trigger("over",t,this._uiHash(this)),this.containers[i].containerCache.over=1)}},_createHelper:function(t){var e=this.options,t=f.isFunction(e.helper)?f(e.helper.apply(this.element[0],[t,this.currentItem])):"clone"==e.helper?this.currentItem.clone():this.currentItem;return t.parents("body").length||f("parent"!=e.appendTo?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(t[0]),t[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),""!=t[0].style.width&&!e.forceHelperSize||t.width(this.currentItem.width()),""!=t[0].style.height&&!e.forceHelperSize||t.height(this.currentItem.height()),t},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),"left"in(t=f.isArray(t)?{left:+t[0],top:+t[1]||0}:t)&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&f.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),{top:(t=this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&f.browser.msie?{top:0,left:0}:t).top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){var t;return"relative"==this.cssPosition?{top:(t=this.currentItem.position()).top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}:{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i=this.options;"parent"==i.containment&&(i.containment=this.helper[0].parentNode),"document"!=i.containment&&"window"!=i.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,f("document"==i.containment?document:window).width()-this.helperProportions.width-this.margins.left,(f("document"==i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(t=f(i.containment)[0],i=f(i.containment).offset(),e="hidden"!=f(t).css("overflow"),this.containment=[i.left+(parseInt(f(t).css("borderLeftWidth"),10)||0)+(parseInt(f(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(f(t).css("borderTopWidth"),10)||0)+(parseInt(f(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(e?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(f(t).css("borderLeftWidth"),10)||0)-(parseInt(f(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(e?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(f(t).css("borderTopWidth"),10)||0)-(parseInt(f(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,e){e=e||this.position;var t="absolute"==t?1:-1,i=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&f.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),n=/(html|body)/i.test(i[0].tagName);return{top:e.top+this.offset.relative.top*t+this.offset.parent.top*t-(f.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():n?0:i.scrollTop())*t),left:e.left+this.offset.relative.left*t+this.offset.parent.left*t-(f.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():n?0:i.scrollLeft())*t)}},_generatePosition:function(t){var e=this.options,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&f.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,n=/(html|body)/i.test(i[0].tagName),s=("relative"!=this.cssPosition||this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),t.pageX),o=t.pageY;return this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3])&&(o=this.containment[3]+this.offset.click.top),e.grid)&&(t=this.originalPageY+Math.round((o-this.originalPageY)/e.grid[1])*e.grid[1],o=this.containment&&(t-this.offset.click.top<this.containment[1]||t-this.offset.click.top>this.containment[3])?t-this.offset.click.top<this.containment[1]?t+e.grid[1]:t-e.grid[1]:t,t=this.originalPageX+Math.round((s-this.originalPageX)/e.grid[0])*e.grid[0],s=this.containment&&(t-this.offset.click.left<this.containment[0]||t-this.offset.click.left>this.containment[2])?t-this.offset.click.left<this.containment[0]?t+e.grid[0]:t-e.grid[0]:t),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(f.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():n?0:i.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(f.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():n?0:i.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var s=this,o=this.counter;window.setTimeout(function(){o==s.counter&&s.refreshPositions(!n)},0)},_clear:function(t,e){this.reverting=!1;var i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]==this.currentItem[0]){for(var n in this._storedCSS)"auto"!=this._storedCSS[n]&&"static"!=this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!e&&i.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev==this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent==this.currentItem.parent()[0]||e||i.push(function(t){this._trigger("update",t,this._uiHash())}),this===this.currentContainer||e||(i.push(function(t){this._trigger("remove",t,this._uiHash())}),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)));for(n=this.containers.length-1;0<=n;n--)e||i.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over&&(i.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over=0);if(this._storedCursor&&f("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){this._trigger("beforeStop",t,this._uiHash());for(n=0;n<i.length;n++)i[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1}if(e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(n=0;n<i.length;n++)i[n].call(this,t);this._trigger("stop",t,this._uiHash())}return!(this.fromOutside=!1)},_trigger:function(){!1===f.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var e=t||this;return{helper:e.helper,placeholder:e.placeholder||f([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:t?t.element:null}}}),f.extend(f.ui.sortable,{version:"1.8.24"})}(jQuery),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t(window.jQuery)}(function(r){"use strict";var e=0;r.ajaxTransport("iframe",function(s){var o,a;if(s.async&&("POST"===s.type||"GET"===s.type))return{send:function(t,n){o=r('<form style="display:none;"></form>'),a=r('<iframe src="javascript:false;" name="iframe-transport-'+(e+=1)+'"></iframe>').bind("load",function(){var i,e=r.isArray(s.paramName)?s.paramName:[s.paramName];a.unbind("load").bind("load",function(){var e;try{if(!(e=a.contents()).length||!e[0].firstChild)throw new Error}catch(t){e=void 0}n(200,"success",{iframe:e}),r('<iframe src="javascript:false;"></iframe>').appendTo(o),o.remove()}),o.prop("target",a.prop("name")).prop("action",s.url).prop("method",s.type),s.formData&&r.each(s.formData,function(t,e){r('<input type="hidden"/>').prop("name",e.name).val(e.value).appendTo(o)}),s.fileInput&&s.fileInput.length&&"POST"===s.type&&(i=s.fileInput.clone(),s.fileInput.after(function(t){return i[t]}),s.paramName&&s.fileInput.each(function(t){r(this).prop("name",e[t]||s.paramName)}),o.append(s.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),o.submit(),i&&i.length&&s.fileInput.each(function(t,e){t=r(i[t]);r(e).prop("name",t.prop("name")),t.replaceWith(e)})}),o.append(a).appendTo(document.body)},abort:function(){a&&a.unbind("load").prop("src","javascript".concat(":false;")),o&&o.remove()}}}),r.ajaxSetup({converters:{"iframe text":function(t){return r(t[0].body).text()},"iframe json":function(t){return r.parseJSON(r(t[0].body).text())},"iframe html":function(t){return r(t[0].body).html()},"iframe script":function(t){return r.globalEval(r(t[0].body).text())}}})}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],t):t(window.jQuery)}(function(d){"use strict";d.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),d.support.xhrFormDataFileUpload=!!window.FormData,d.widget("blueimp.fileupload",{options:{namespace:void 0,dropZone:d(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(t){return t.serializeArray()},add:function(t,e){e.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["namespace","dropZone","fileInput","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date,this.loaded=0,this.bitrate=0,this.getBitrate=function(t,e,i){var n=t-this.timestamp;return this.bitrate&&i&&!(i<n)||(this.bitrate=(e-this.loaded)*(1e3/n)*8,this.loaded=e,this.timestamp=t),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&d.support.xhrFileUpload||d.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return"function"==typeof t.formData?t.formData(t.form):d.isArray(t.formData)?t.formData:t.formData?(i=[],d.each(t.formData,function(t,e){i.push({name:t,value:e})}),i):[]},_getTotal:function(t){var i=0;return d.each(t,function(t,e){i+=e.size||1}),i},_onProgress:function(t,e){var i,n,s;t.lengthComputable&&(i=+new Date,e._time&&e.progressInterval&&i-e._time<e.progressInterval&&t.loaded!==t.total||(e._time=i,n=e.total||this._getTotal(e.files),s=parseInt(t.loaded/t.total*(e.chunkSize||n),10)+(e.uploadedBytes||0),this._loaded+=s-(e.loaded||e.uploadedBytes||0),e.lengthComputable=!0,e.loaded=s,e.total=n,e.bitrate=e._bitrateTimer.getBitrate(i,s,e.bitrateInterval),this._trigger("progress",t,e),this._trigger("progressall",t,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(i,this._loaded,e.bitrateInterval)})))},_initProgressListener:function(i){var n=this,t=(i.xhr?i:d.ajaxSettings).xhr();t.upload&&(d(t.upload).bind("progress",function(t){var e=t.originalEvent;t.lengthComputable=e.lengthComputable,t.loaded=e.loaded,t.total=e.total,n._onProgress(t,i)}),i.xhr=function(){return t})},_initXHRData:function(i){var n,t=i.files[0],e=i.multipart||!d.support.xhrFileUpload,s=i.paramName[0];e&&!i.blob||(i.headers=d.extend(i.headers,{"X-File-Name":t.name,"X-File-Type":t.type,"X-File-Size":t.size}),i.blob?e||(i.contentType="application/octet-stream",i.data=i.blob):(i.contentType=t.type,i.data=t)),e&&d.support.xhrFormDataFileUpload&&(i.postMessage?(n=this._getFormData(i),i.blob?n.push({name:s,value:i.blob}):d.each(i.files,function(t,e){n.push({name:i.paramName[t]||s,value:e})})):(i.formData instanceof FormData?n=i.formData:(n=new FormData,d.each(this._getFormData(i),function(t,e){n.append(e.name,e.value)})),i.blob?n.append(s,i.blob,t.name):d.each(i.files,function(t,e){e instanceof Blob&&n.append(i.paramName[t]||s,e,e.name)})),i.data=n),i.blob=null},_initIframeSettings:function(t){t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&d("<a></a>").prop("href",t.url).prop("host")!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(t){this._isXHRUpload(t)?(this._chunkedUpload(t,!0)||(t.data||this._initXHRData(t),this._initProgressListener(t)),t.postMessage&&(t.dataType="postmessage "+(t.dataType||""))):this._initIframeSettings(t,"iframe")},_getParamName:function(t){var e=d(t.fileInput),n=t.paramName;return n?d.isArray(n)||(n=[n]):(n=[],e.each(function(){for(var t=d(this),e=t.prop("name")||"files[]",i=(t.prop("files")||[1]).length;i;)n.push(e),--i}),n.length||(n=[e.prop("name")||"files[]"])),n},_initFormSettings:function(t){t.form&&t.form.length||(t.form=d(t.fileInput.prop("form"))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&(t.type="POST")},_getAJAXSettings:function(t){t=d.extend({},this.options,t);return this._initFormSettings(t),this._initDataSettings(t),t},_enhancePromise:function(t){return t.success=t.done,t.error=t.fail,t.complete=t.always,t},_getXHRPromise:function(t,e,i){var n=d.Deferred(),s=n.promise();return e=e||this.options.context||s,!0===t?n.resolveWith(e,i):!1===t&&n.rejectWith(e,i),s.abort=n.promise,this._enhancePromise(s)},_chunkedUpload:function(i,t){var n,s,o=this,a=i.files[0],e=a.size,r=i.uploadedBytes=i.uploadedBytes||0,l=i.maxChunkSize||e,c=a.webkitSlice||a.mozSlice||a.slice;return!(!(this._isXHRUpload(i)&&c&&(r||l<e))||i.data)&&(!!t||(e<=r?(a.error="uploadedBytes",this._getXHRPromise(!1,i.context,[null,"error",a.error])):(t=Math.ceil((e-r)/l),(e=(n=function(e){return e?n(--e).pipe(function(){var t=d.extend({},i);return t.blob=c.call(a,r+e*l,r+(e+1)*l),t.chunkSize=t.blob.size,o._initXHRData(t),o._initProgressListener(t),s=(d.ajax(t)||o._getXHRPromise(!1,t.context)).done(function(){t.loaded||o._onProgress(d.Event("progress",{lengthComputable:!0,loaded:t.chunkSize,total:t.chunkSize}),t),i.uploadedBytes=t.uploadedBytes+=t.chunkSize})}):o._getXHRPromise(!0,i.context)})(t)).abort=function(){return s.abort()},this._enhancePromise(e))))},_beforeSend:function(t,e){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer),this._active+=1,this._loaded+=e.uploadedBytes||0,this._total+=this._getTotal(e.files)},_onDone:function(t,e,i,n){this._isXHRUpload(n)||this._onProgress(d.Event("progress",{lengthComputable:!0,loaded:1,total:1}),n),n.result=t,n.textStatus=e,n.jqXHR=i,this._trigger("done",null,n)},_onFail:function(t,e,i,n){n.jqXHR=t,n.textStatus=e,n.errorThrown=i,this._trigger("fail",null,n),n.recalculateProgress&&(this._loaded-=n.loaded||n.uploadedBytes||0,this._total-=n.total||this._getTotal(n.files))},_onAlways:function(t,e,i,n){--this._active,n.textStatus=e,i&&i.always?(n.jqXHR=i,n.result=t):(n.jqXHR=t,n.errorThrown=i),this._trigger("always",null,n),0===this._active&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(i,t){function e(t,e){return o._sending+=1,a._bitrateTimer=new o._BitrateTimer,n=n||(!1!==t&&!1!==o._trigger("send",i,a)&&(o._chunkedUpload(a)||d.ajax(a))||o._getXHRPromise(!1,a.context,e)).done(function(t,e,i){o._onDone(t,e,i,a)}).fail(function(t,e,i){o._onFail(t,e,i,a)}).always(function(t,e,i){if(--o._sending,o._onAlways(t,e,i,a),a.limitConcurrentUploads&&a.limitConcurrentUploads>o._sending)for(var n=o._slots.shift();n;){if(!n.isRejected()){n.resolve();break}n=o._slots.shift()}})}var n,s,o=this,a=o._getAJAXSettings(t);return this._beforeSend(i,a),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?((t=1<this.options.limitConcurrentUploads?(s=d.Deferred(),this._slots.push(s),s.pipe(e)):this._sequence=this._sequence.pipe(e,e)).abort=function(){var t=[void 0,"abort","abort"];return n?n.abort():(s&&s.rejectWith(t),e(!1,t))},this._enhancePromise(t)):e()},_onAdd:function(n,s){var o,t,a,e,r=this,l=!0,i=d.extend({},this.options,s),c=i.limitMultiFileUploads,h=this._getParamName(i);if((i.singleFileUploads||c)&&this._isXHRUpload(i))if(!i.singleFileUploads&&c)for(a=[],o=[],e=0;e<s.files.length;e+=c)a.push(s.files.slice(e,e+c)),(t=h.slice(e,e+c)).length||(t=h),o.push(t);else o=h;else a=[s.files],o=[h];return s.originalFiles=s.files,d.each(a||s.files,function(t,e){var i=d.extend({},s);return i.files=a?e:[e],i.paramName=o[t],i.submit=function(){return i.jqXHR=this.jqXHR=!1!==r._trigger("submit",n,this)&&r._onSend(n,this),this.jqXHR},l=r._trigger("add",n,i)}),l},_normalizeFile:function(t,e){void 0===e.name&&void 0===e.size&&(e.name=e.fileName,e.size=e.fileSize)},_replaceFileInput:function(i){var n=i.clone(!0);d("<form></form>").append(n)[0].reset(),i.after(n).detach(),d.cleanData(i.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(t,e){return e===i[0]?n[0]:e}),i[0]===this.element[0]&&(this.element=n)},_onChange:function(t){var e=t.data.fileupload,i={files:d.each(d.makeArray(t.target.files),e._normalizeFile),fileInput:d(t.target),form:d(t.target.form)};if(i.files.length||(i.files=[{name:t.target.value.replace(/^.*\\/,"")}]),e.options.replaceFileInput&&e._replaceFileInput(i.fileInput),!1===e._trigger("change",t,i)||!1===e._onAdd(t,i))return!1},_onPaste:function(t){var e=t.data.fileupload,i=t.originalEvent.clipboardData,i=i&&i.items||[],n={files:[]};if(d.each(i,function(t,e){e=e.getAsFile&&e.getAsFile();e&&n.files.push(e)}),!1===e._trigger("paste",t,n)||!1===e._onAdd(t,n))return!1},_onDrop:function(t){var e=t.data.fileupload,i=t.dataTransfer=t.originalEvent.dataTransfer,i={files:d.each(d.makeArray(i&&i.files),e._normalizeFile)};if(!1===e._trigger("drop",t,i)||!1===e._onAdd(t,i))return!1;t.preventDefault()},_onDragOver:function(t){var e=t.data.fileupload,i=t.dataTransfer=t.originalEvent.dataTransfer;if(!1===e._trigger("dragover",t))return!1;i&&(i.dropEffect="copy"),t.preventDefault()},_initEventHandlers:function(){var t=this.options.namespace;this._isXHRUpload(this.options)&&this.options.dropZone.bind("dragover."+t,{fileupload:this},this._onDragOver).bind("drop."+t,{fileupload:this},this._onDrop).bind("paste."+t,{fileupload:this},this._onPaste),this.options.fileInput.bind("change."+t,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var t=this.options.namespace;this.options.dropZone.unbind("dragover."+t,this._onDragOver).unbind("drop."+t,this._onDrop).unbind("paste."+t,this._onPaste),this.options.fileInput.unbind("change."+t,this._onChange)},_setOption:function(t,e){var i=-1!==d.inArray(t,this._refreshOptionsList);i&&this._destroyEventHandlers(),d.Widget.prototype._setOption.call(this,t,e),i&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is("input:file")?this.element:this.element.find("input:file"):t.fileInput instanceof d||(t.fileInput=d(t.fileInput)),t.dropZone instanceof d||(t.dropZone=d(t.dropZone))},_create:function(){var t=this.options;d.extend(t,d(this.element[0].cloneNode(!1)).data()),t.namespace=t.namespace||this.widgetName,this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=this._loaded=this._total=0,this._initEventHandlers()},destroy:function(){this._destroyEventHandlers(),d.Widget.prototype.destroy.call(this)},enable:function(){d.Widget.prototype.enable.call(this),this._initEventHandlers()},disable:function(){this._destroyEventHandlers(),d.Widget.prototype.disable.call(this)},add:function(t){t&&!this.options.disabled&&(t.files=d.each(d.makeArray(t.files),this._normalizeFile),this._onAdd(null,t))},send:function(t){return t&&!this.options.disabled&&(t.files=d.each(d.makeArray(t.files),this._normalizeFile),t.files.length)?this._onSend(null,t):this._getXHRPromise(!1,t&&t.context)}})}),function(a){var o=new Array,r=new Array;a.fn.doAutosize=function(t){var e=a(this).data("minwidth"),i=a(this).data("maxwidth"),n="",s=a(this),o=a("#"+a(this).data("tester_id"));""!==(n=s.val())&&(n=n.replace(/&/g,"&").replace(/\s/g," ").replace(/</g,"<").replace(/>/g,">"),o.html(n),(o=(n=o.width())+t.comfortZone>=e?n+t.comfortZone:e)<s.width()&&e<=o||e<o&&o<i)&&s.width(o)},a.fn.resetAutosize=function(t){var e=a(this).data("minwidth")||t.minInputWidth||a(this).width(),t=a(this).data("maxwidth")||t.maxInputWidth||a(this).closest(".tagsinput").width()-t.inputPadding,i=a(this),n=a("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:i.css("fontSize"),fontFamily:i.css("fontFamily"),fontWeight:i.css("fontWeight"),letterSpacing:i.css("letterSpacing"),whiteSpace:"nowrap"}),s=a(this).attr("id")+"_autosize_tester";0<!a("#"+s).length&&(n.attr("id",s),n.appendTo("body")),i.data("minwidth",e),i.data("maxwidth",t),i.data("tester_id",s),i.css("width",e)},a.fn.addTag=function(n,s){return s=jQuery.extend({focus:!1,callback:!0},s),this.each(function(){var t,e=a(this).attr("id"),i=a(this).val().split(o[e]);""==i[0]&&(i=new Array),n=jQuery.trim(n),s.unique?1==(t=a(i).tagExist(n))&&a("#"+e+"_tag").addClass("not_valid"):t=!1,""!=n&&1!=t&&(a("<span>").addClass("tag").append(a("<span>").text(n).append(""),a("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return a("#"+e).removeTag(escape(n))})).insertBefore("#"+e+"_addTag"),i.push(n),a("#"+e+"_tag").val(""),s.focus?a("#"+e+"_tag").focus():a("#"+e+"_tag").blur(),a.fn.tagsInput.updateTagsField(this,i),s.callback&&r[e]&&r[e].onAddTag&&r[e].onAddTag.call(this,n),r[e])&&r[e].onChange&&(t=i.length,r[e].onChange.call(this,a(this),i[t-1]))}),!1},a.fn.removeTag=function(n){return n=unescape(n),this.each(function(){var t=a(this).attr("id"),e=a(this).val().split(o[t]);a("#"+t+"_tagsinput .tag").remove(),str="";for(var i=0;i<e.length;i++)e[i]!=n&&(str=str+o[t]+e[i]);a.fn.tagsInput.importTags(this,str),r[t]&&r[t].onRemoveTag&&r[t].onRemoveTag.call(this,n)}),!1},a.fn.tagExist=function(t){return 0<=jQuery.inArray(t,a(this))},a.fn.importTags=function(t){id=a(this).attr("id"),a("#"+id+"_tagsinput .tag").remove(),a.fn.tagsInput.importTags(this,t)},a.fn.tagsInput=function(t){var s=jQuery.extend({interactive:!0,defaultText:"add a tag",minChars:0,width:"300px",height:"100px",autocomplete:{selectFirst:!1},hide:!0,delimiter:",",unique:!0,removeWithBackspace:!0,placeholderColor:"#666666",autosize:!0,comfortZone:20,inputPadding:12},t);return this.each(function(){s.hide&&a(this).hide();var n=a(this).attr("id"),t=jQuery.extend({pid:n,real_input:"#"+n,holder:"#"+n+"_tagsinput",input_wrapper:"#"+n+"_addTag",fake_input:"#"+n+"_tag"},s),e=(o[n]=t.delimiter,(s.onAddTag||s.onRemoveTag||s.onChange)&&(r[n]=new Array,r[n].onAddTag=s.onAddTag,r[n].onRemoveTag=s.onRemoveTag,r[n].onChange=s.onChange),'<div id="'+n+'_tagsinput" class="tagsinput"><div id="'+n+'_addTag">');if(s.interactive&&(e=e+'<input id="'+n+'_tag" value="" data-default="'+s.defaultText+'" />'),a(e+='</div><div class="tags_clear"></div></div>').insertAfter(this),a(t.holder).css("width",s.width),a(t.holder).css("height",s.height),""!=a(t.real_input).val()&&a.fn.tagsInput.importTags(a(t.real_input),a(t.real_input).val()),s.interactive){if(a(t.fake_input).val(a(t.fake_input).attr("data-default")),a(t.fake_input).css("color",s.placeholderColor),a(t.fake_input).resetAutosize(s),a(t.holder).bind("click",t,function(t){a(t.data.fake_input).focus()}),a(t.fake_input).bind("focus",t,function(t){a(t.data.fake_input).val()==a(t.data.fake_input).attr("data-default")&&a(t.data.fake_input).val(""),a(t.data.fake_input).css("color","#000000")}),null!=s.autocomplete_url){for(attrname in autocomplete_options={source:s.autocomplete_url},s.autocomplete)autocomplete_options[attrname]=s.autocomplete[attrname];void 0!==jQuery.Autocompleter?(a(t.fake_input).autocomplete(s.autocomplete_url,s.autocomplete),a(t.fake_input).bind("result",t,function(t,e,i){e&&a("#"+n).addTag(e[0]+"",{focus:!0,unique:s.unique})})):void 0!==jQuery.ui.autocomplete&&(a(t.fake_input).autocomplete(autocomplete_options),a(t.fake_input).bind("autocompleteselect",t,function(t,e){return a(t.data.real_input).addTag(e.item.value,{focus:!0,unique:s.unique}),!1}))}else a(t.fake_input).bind("blur",t,function(t){var e=a(this).attr("data-default");return""!=a(t.data.fake_input).val()&&a(t.data.fake_input).val()!=e?t.data.minChars<=a(t.data.fake_input).val().length&&(!t.data.maxChars||t.data.maxChars>=a(t.data.fake_input).val().length)&&a(t.data.real_input).addTag(a(t.data.fake_input).val(),{focus:!0,unique:s.unique}):(a(t.data.fake_input).val(a(t.data.fake_input).attr("data-default")),a(t.data.fake_input).css("color",s.placeholderColor)),!1});a(t.fake_input).bind("keypress",t,function(t){if(t.which==t.data.delimiter.charCodeAt(0)||13==t.which)return t.preventDefault(),t.data.minChars<=a(t.data.fake_input).val().length&&(!t.data.maxChars||t.data.maxChars>=a(t.data.fake_input).val().length)&&a(t.data.real_input).addTag(a(t.data.fake_input).val(),{focus:!0,unique:s.unique}),a(t.data.fake_input).resetAutosize(s),!1;t.data.autosize&&a(t.data.fake_input).doAutosize(s)}),t.removeWithBackspace&&a(t.fake_input).bind("keydown",function(t){var e;8==t.keyCode&&""==a(this).val()&&(t.preventDefault(),t=a(this).closest(".tagsinput").find(".tag:last").text(),e=a(this).attr("id").replace(/_tag$/,""),t=t.replace(/[\s]+x$/,""),a("#"+e).removeTag(escape(t)),a(this).trigger("focus"))}),a(t.fake_input).blur(),t.unique&&a(t.fake_input).keydown(function(t){8!=t.keyCode&&!String.fromCharCode(t.which).match(/\w+|[,\/]+/)||a(this).removeClass("not_valid")})}return!1}),this},a.fn.tagsInput.updateTagsField=function(t,e){var i=a(t).attr("id");a(t).val(e.join(o[i]))},a.fn.tagsInput.importTags=function(t,e){a(t).val("");for(var i=a(t).attr("id"),n=e.split(o[i]),s=0;s<n.length;s++)a(t).addTag(n[s],{focus:!1,callback:!1});r[i]&&r[i].onChange&&r[i].onChange.call(t,t,n[s])}}(jQuery),function(_){_.iButton={version:"1.0.03",setDefaults:function(t){_.extend(y,t)}},_.fn.iButton=function(t){var i,n="string"==typeof t&&t,s=n&&Array.prototype.slice.call(arguments,1)||arguments,o=0==this.length?null:_.data(this[0],"iButton");return o&&n&&this.length?"object"==n.toLowerCase()?o:o[n]&&(this.each(function(t){var e=_.data(this,"iButton")[n].apply(o,s);if(0==t&&e){if(!e.jquery)return i=e,!1;i=_([]).add(e)}else e&&e.jquery&&(i=i.add(e))}),i)||this:this.each(function(){new e(this,t)})};var b=0,e=(_.browser.iphone=-1<navigator.userAgent.toLowerCase().indexOf("iphone"),function(t,n){var s,o,i,a,r,l,c,h,d=this,f=_(t),e=++b,u=!1,t={},p={dragging:!1,clicked:null},g={position:null,offset:null,time:null},m=(n=_.extend({},y,n,_.metadata?f.metadata():{})).labelOn==w&&n.labelOff==x,v=":checkbox, :radio";if(!f.is(v))return f.find(v).iButton(n);_.data(f[0],"iButton")||(_.data(f[0],"iButton",d),"auto"==n.resizeHandle&&(n.resizeHandle=!m),"auto"==n.resizeContainer&&(n.resizeContainer=!m),this.toggle=function(t){var e=0<arguments.length?t:!f[0].checked;f.attr("checked",e).trigger("change")},this.disable=function(t){var e=0<arguments.length?t:!u;u=e,f.attr("disabled",e),s[e?"addClass":"removeClass"](n.classDisabled),_.isFunction(n.disable)&&n.disable.apply(d,[u,f,n])},this.repaint=function(){c()},this.destroy=function(){_([f[0],s[0]]).unbind(".iButton"),_(document).unbind(".iButton_"+e),s.after(f).remove(),_.data(f[0],"iButton",null),_.isFunction(n.destroy)&&n.destroy.apply(d,[f,n])},f.wrap('<div class="'+_.trim(n.classContainer+" "+n.className)+'" />').after('<div class="'+n.classHandle+'"><div class="'+n.classHandleRight+'"><div class="'+n.classHandleMiddle+'" /></div></div><div class="'+n.classLabelOff+'"><span><label>'+n.labelOff+'</label></span></div><div class="'+n.classLabelOn+'"><span><label>'+n.labelOn+'</label></span></div><div class="'+n.classPaddingLeft+'"></div><div class="'+n.classPaddingRight+'"></div>'),s=f.parent(),o=f.siblings("."+n.classHandle),m=f.siblings("."+n.classLabelOff),i=m.children("span"),a=f.siblings("."+n.classLabelOn),r=a.children("span"),(n.resizeHandle||n.resizeContainer)&&(t.onspan=r.outerWidth(),t.offspan=i.outerWidth()),n.resizeHandle?(t.handle=Math.min(t.onspan,t.offspan),o.css("width",t.handle)):t.handle=o.width(),n.resizeContainer?(t.container=Math.max(t.onspan,t.offspan)+t.handle+20,s.css("width",t.container),m.css("width",t.container-5)):t.container=s.width(),l=t.container-t.handle-6,(c=function(t){var e=f[0].checked?l:0,t=!(0<arguments.length)||arguments[0];t&&n.enableFx?(o.stop().animate({left:e},n.duration,n.easing),a.stop().animate({width:e+4},n.duration,n.easing),r.stop().animate({marginLeft:e-l},n.duration,n.easing),i.stop().animate({marginRight:-e},n.duration,n.easing)):(o.css("left",e),a.css("width",e+4),r.css("marginLeft",e-l),i.css("marginRight",-e))})(!1),h=function(t){return t.pageX||(t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].pageX:0)},s.bind("mousedown.iButton touchstart.iButton",function(t){if(!(_(t.target).is(v)||u||!n.allowRadioUncheck&&f.is(":radio:checked")))return t.preventDefault(),p.clicked=o,g.position=h(t),g.offset=g.position-(parseInt(o.css("left"),10)||0),g.time=(new Date).getTime(),!1}),n.enableDrag&&_(document).bind("mousemove.iButton_"+e+" touchmove.iButton_"+e,function(t){if(p.clicked==o)return t.preventDefault(),(t=h(t))!=g.offset&&(p.dragging=!0,s.addClass(n.classHandleActive)),t=Math.min(1,Math.max(0,(t-g.offset)/l)),o.css("left",t*l),a.css("width",t*l+4),i.css("marginRight",-t*l),r.css("marginLeft",-(1-t)*l),!1}),_(document).bind("mouseup.iButton_"+e+" touchend.iButton_"+e,function(t){var e,i;if(p.clicked==o)return t.preventDefault(),e=!0,!p.dragging||(new Date).getTime()-g.time<n.clickOffset?(i=f[0].checked,f.attr("checked",!i),_.isFunction(n.click)&&n.click.apply(d,[!i,f,n])):(i=.5<=(h(t)-g.offset)/l,f[0].checked==i&&(e=!1),f.attr("checked",i)),s.removeClass(n.classHandleActive),p.clicked=null,p.dragging=null,e?f.trigger("change"):c(),!1}),f.bind("change.iButton",function(){var t;c(),f.is(":radio")&&(t=f[0],_(t.form?t.form[t.name]:":radio[name="+t.name+"]").filter(":not(:checked)").iButton("repaint")),_.isFunction(n.change)&&n.change.apply(d,[f,n])}).bind("focus.iButton",function(){s.addClass(n.classFocus)}).bind("blur.iButton",function(){s.removeClass(n.classFocus)}),_.isFunction(n.click)&&f.bind("click.iButton",function(){n.click.apply(d,[f[0].checked,f,n])}),f.is(":disabled")&&this.disable(!0),_.browser.msie&&(s.find("*").andSelf().attr("unselectable","on"),f.bind("click.iButton",function(){f.triggerHandler("change.iButton")})),_.isFunction(n.init)&&n.init.apply(d,[f,n]))}),y={duration:200,easing:"swing",labelOn:"ON",labelOff:"OFF",resizeHandle:"auto",resizeContainer:"auto",enableDrag:!0,enableFx:!0,allowRadioUncheck:!1,clickOffset:120,className:"",classContainer:"ibutton-container",classDisabled:"ibutton-disabled",classFocus:"ibutton-focus",classLabelOn:"ibutton-label-on",classLabelOff:"ibutton-label-off",classHandle:"ibutton-handle",classHandleMiddle:"ibutton-handle-middle",classHandleRight:"ibutton-handle-right",classHandleActive:"ibutton-active-handle",classPaddingLeft:"ibutton-padding-left",classPaddingRight:"ibutton-padding-right",init:null,change:null,click:null,disable:null,destroy:null},w=y.labelOn,x=y.labelOff}(jQuery),function(s){function o(t,e){this.path=t,null!=e?(this.at_2x_path=e,this.perform_check=!1):(this.at_2x_path=t.replace(/\.\w+$/,function(t){return"@2x"+t}),this.perform_check=!0)}function e(t){var e;/@2x\.\w+$/.test(s(t).attr("src"))||(this.el=t,this.path=new o(s(t).attr("src"),s(t).attr("data-at2x")),(e=this).path.check_2x_variant(function(t){t&&e.swap()}))}s.fn.retina=function(t){if(s.Retina.isRetina())return s.Retina.opts=s.extend(s.Retina.opts,t),this.each(function(){s(this).is("img")&&new e(this)})},s.Retina=function(){},s.Retina.opts={check_mime_type:!0,force_original_dimensions:!0},s.Retina.isRetina=function(){return!!(1<window.devicePixelRatio||window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(min--moz-device-pixel-ratio: 1.5),(-o-min-device-pixel-ratio: 3/2),(min-resolution: 1.5dppx)").matches)},o.confirmed_paths=[],o.prototype.is_external=function(){return!(!this.path.match(/^(https?\:|\/\/)/i)||this.path.match("//"+document.domain+"/"))},o.prototype.check_2x_variant=function(e){var i,n=this;if(this.is_external()||!this.perform_check&&void 0!==this.at_2x_path&&null!==this.at_2x_path||this.at_2x_path in o.confirmed_paths)return e(!0);(i=new XMLHttpRequest).open("HEAD",this.at_2x_path),i.onreadystatechange=function(){if(4==i.readyState&&200<=i.status&&i.status<=399){if(s.Retina.opts.check_mime_type){var t=i.getResponseHeader("Content-Type");if(null===t||!t.match(/^image/i))return e(!1)}return o.confirmed_paths.push(n.at_2x_path),e(!0)}return e(!1)},i.send()},(s.RetinaImage=e).prototype.swap=function(i){void 0===i&&(i=this.path.at_2x_path);var n=this;!function t(){var e;n.el.complete?(s.Retina.opts.force_original_dimensions&&(n.el.setAttribute("width",n.el.offsetWidth),n.el.setAttribute("height",n.el.offsetHeight)),e=n.el.src,n.el.setAttribute("src",i),s(n.el).one("error",function(){n.el.setAttribute("src",e)})):setTimeout(t,5)}()}}(jQuery),function(r,s,o){function l(e){var t={text:"",start:0,end:0};if(e.value)try{if(s.getSelection)t.start=e.selectionStart,t.end=e.selectionEnd,t.text=e.value.slice(t.start,t.end);else if(o.selection){e.focus();var i=o.selection.createRange(),n=o.body.createTextRange();t.text=i.text;try{n.moveToElementText(e),n.setEndPoint("StartToStart",i)}catch(t){(n=e.createTextRange()).setEndPoint("StartToStart",i)}t.start=e.value.length-n.text.length,t.end=t.start+i.text.length}}catch(t){}return t}var i={getPos:function(t){t=l(t);return{start:t.start,end:t.end}},setPos:function(t,e,i){"start"===(i=this._caretMode(i))?e.end=e.start:"end"===i&&(e.start=e.end),t.focus();try{var n;t.createTextRange?(n=t.createTextRange(),0<=s.navigator.userAgent.toLowerCase().indexOf("msie")&&(e.start=t.value.substr(0,e.start).replace(/\r/g,"").length,e.end=t.value.substr(0,e.end).replace(/\r/g,"").length),n.collapse(!0),n.moveStart("character",e.start),n.moveEnd("character",e.end-e.start),n.select()):t.setSelectionRange&&t.setSelectionRange(e.start,e.end)}catch(t){}},getText:function(t){return l(t).text},_caretMode:function(t){switch(t=!1===(t=t||"keep")?"end":t){case"keep":case"start":case"end":break;default:t="keep"}return t},replace:function(t,e,i){var n=l(t),s=t.value,o=r(t).scrollTop(),a={start:n.start,end:n.start+e.length};t.value=s.substr(0,n.start)+e+s.substr(n.end),r(t).scrollTop(o),this.setPos(t,a,i)},insertBefore:function(t,e,i){var n=l(t),s=t.value,o=r(t).scrollTop(),a={start:n.start+e.length,end:n.end+e.length};t.value=s.substr(0,n.start)+e+s.substr(n.start),r(t).scrollTop(o),this.setPos(t,a,i)},insertAfter:function(t,e,i){var n=l(t),s=t.value,o=r(t).scrollTop(),a={start:n.start,end:n.end};t.value=s.substr(0,n.end)+e+s.substr(n.end),r(t).scrollTop(o),this.setPos(t,a,i)}};r.extend({selection:function(t){var e,i,t="text"===(t||"text").toLowerCase();try{if(s.getSelection)return t?s.getSelection().toString():((e=s.getSelection()).getRangeAt?i=e.getRangeAt(0):((i=o.createRange()).setStart(e.anchorNode,e.anchorOffset),i.setEnd(e.focusNode,e.focusOffset)),r("<div></div>").append(i.cloneContents()).html());if(o.selection)return t?o.selection.createRange().text:o.selection.createRange().htmlText}catch(t){}return""}}),r.fn.extend({selection:function(t,e){switch(e=e||{},t){case"getPos":return i.getPos(this[0]);case"setPos":return this.each(function(){i.setPos(this,e)});case"replace":return this.each(function(){i.replace(this,e.text,e.caret)});case"insert":return this.each(function(){"before"===e.mode?i.insertBefore(this,e.text,e.caret):i.insertAfter(this,e.text,e.caret)});default:return i.getText(this[0])}return this}})}(jQuery,window,window.document),function(v){v.fn.inlineEditable=function(t,e){var h,d,f,u,p;if(this.length)return h=!1,"string"==typeof t?"setOption"==t&&(d=this.data("inlineEditableSettings")||{},v.extend(!0,d,e),void 0!==e.hold&&"function"!=typeof e.hold&&(d.hold=n(d.hold)),this.data("inlineEditableSettings",d)):(e=this.data("inlineEditableSettings"),this.data("inlineEditableSettings",v.extend({inputType:"text",inputClass:"",size:{height:null,width:null},minSize:{height:null,width:null},maxSize:{height:null,width:null},editLink:null,editOnItself:!0,placeholder:null,makeReadableBy:["blur","enter","esc"],updateBy:["ctrl+enter","alt+enter"],beforeBackReadable:function(){},afterBackReadable:function(){},beforeMakeEditable:function(){},afterMakeEditable:function(){},placeholderClass:"hint",truncate:!1,hold:!1,html:!1,allowEmpty:!1},e,t||{})),d=this.data("inlineEditableSettings")||{},f=this,u="read",p="","function"!=typeof d.hold&&(d.hold=n(d.hold)),function(){var t;this.data("inited")||(d.truncate&&"boolean"==typeof d.truncate&&(d.truncate=255),d.truncate&&(t=d.placeholder&&d.placeholder===this.text()?"":this.text(),this.data("real_text",t),this.text(t.length<d.truncate-3?t:t.substr(0,d.truncate-3)+"...")),d.placeholder&&s.call(this),d.editLink&&v(d.editLink).unbind("click.inlineEditable").bind("click.inlineEditable",function(){d.hold.call(f)||"edit"!=u&&i.call(f.get(0))}),d.editOnItself&&this.unbind("click.inlineEditable").bind("click.inlineEditable",function(){d.hold.call(f)||"edit"!=u&&i.call(this)}),this.unbind("editable.inlineEditable").bind("editable.inlineEditable",function(){d.hold.call(f)||"edit"!=u&&i.call(this)}),this.unbind("placeholder.inlineEditable").bind("placeholder.inlineEditable",function(t,e){e&&d.placeholder&&s.call(this),e||v(this).removeClass(d.placeholderClass)}),this.data("inited",!0))}.call(this)),this;function s(){m(v(this))||v(this).addClass(d.placeholderClass).text(d.placeholder)}function i(){u="edit",this.id=this.id||(""+Math.random()).slice(2);var t,e,i,n=this.id+"-input",s=v("#"+n);if(s.length||(f.after(function(t){{if("textarea"!==d.inputType)return'<input type="text" id="'+t+'" style="display:none;">';return'<textarea id="'+t+'" style="display:none;"></textarea>'}}(n)),s=v("#"+n)),s.addClass(d.inputClass),n=s,t=f,e=d.size.height||t.height(),t=d.size.width||1.5*t.width(),e=d.minSize.height&&e<d.minSize.height?d.minSize.height:e,t=d.minSize.width&&t<d.minSize.width?d.minSize.width:t,e=d.maxSize.height&&e>d.maxSize.height?d.maxSize.height:e,t=d.maxSize.width&&t>d.maxSize.width?d.maxSize.width:t,n.height(e),n.width(t),d.placeholder&&m(v(this))==d.placeholder&&!function(){m(v(this))==d.placeholder&&v(this).text("").removeClass(d.placeholderClass)}.call(f),d.beforeMakeEditable.call(this,s),p=d.truncate?f.data("real_text"):m(f),s.val(p).show().focus(),f.hide(),v(d.editLink).hide(),!h){for(var o=[],a=[],r=0,l=d.makeReadableBy.length;r<l;++r)"blur"==(c=d.makeReadableBy[r])&&s.blur(function(){"read"!=u&&g.call(this)}),"enter"==c&&o.push(13),"esc"==c&&o.push(27);for(var c,r=0,l=d.updateBy.length;r<l;++r)"alt+enter"==(c=d.updateBy[r])&&a.push({ctrl:!1,alt:!0,shift:!1,key:13}),"ctrl+enter"==c&&a.push({ctrl:!0,alt:!1,shift:!1,key:13}),"ctrl+s"==c&&a.push({ctrl:!0,alt:!1,shift:!1,key:17});o.length&&(i=o,s.keydown(function(t){if(!~i.indexOf(t.keyCode)||t.ctrlKey||t.altKey||t.shiftKey||"read"!=u&&g.call(this,27==t.keyCode?p:null),a.length)for(var e in a){e=a[e];if(t.keyCode==e.key&&t.ctrlKey==e.ctrl&&t.altKey==e.alt&&t.shiftKey==e.shift){f.trigger("readable");break}}})),f.unbind("readable.inlineEditable").bind("readable.inlineEditable",function(t,e){var i;"read"!=u&&(i=this.id+"-input",i=v("#"+i),g.call(i,i.val(),e))}),h=!0}d.afterMakeEditable.call(this,s)}function g(t,e){var i,n;e=void 0!==e,null!=t?v(this).val(t):t=v(this).val(),!1===e&&!1===d.beforeBackReadable.call(f.get(0),this,{changed:t!=p,old_text:p,new_text:t})||(u="read",d.placeholder&&function(t){return!v(t).val()&&(v(this).text(d.placeholder).addClass(d.placeholderClass),!0)}.call(f,this)||(d.allowEmpty||t)&&(d.truncate?(f.data("real_text",t),f.text(t.length<d.truncate-3?t:t.substr(0,d.truncate-3)+"...")):(i=f,n=t,d.html?i.html(n):i.text(n)),t||s.call(this)),f.show(),v(this).hide(),v(d.editLink).show(),!1===e&&d.afterBackReadable.call(f.get(0),this,{changed:t!=p,old_text:p}))}function n(t){return function(){return t}}function m(t){return d.html?t.html():t.text()}}}(jQuery),function(l){l.fn.lazyLoad=function(t,e){var i,n,s,o,a;function r(){if(i.stopped)this.onscroll=null;else if(!i.stopped&&!i.loading&&a(s,n)<=i.distance){if(null!==i.hash){var t=location.hash.replace(/^[^#]*#\/*/,"").split("/")[0];if(-1===i.hash.indexOf(t))return void(this.onscroll=null)}i.load()}}"stop"==t?(i=this.data("lazyLoadSettings"))&&(i.stopped=!0):"reload"==t?(i=this.data("lazyLoadSettings"))&&(i.stopped=!1,i.loading=!1,this.get(0).onscroll=null,this.lazyLoad(i)):"sleep"==t?(i=this.data("lazyLoadSettings"))&&(i.loading=!0):"wake"==t?(i=this.data("lazyLoadSettings"))&&(i.loading=!1):"force"==t?(i=this.data("lazyLoadSettings"))&&!i.loading&&i.load():(this.data("lazyLoadSettings",l.extend({distance:50,load:function(){},container:s,state:"wake",hash:location.hash.replace(/^[^#]*#\/*/,"").split("/")[0]||null,distanceBetweenBottoms:null},t||{})),(i=this.data("lazyLoadSettings")).loading=!1,i.stopped=!1,n=this,s=i.container,null===i.hash||l.isArray(i.hash)||(i.hash=[i.hash]),l.fn.lazyLoad.call(n,i.state),o=setTimeout(function(){if(i.stopped)clearTimeout(o);else{if(null!==i.hash){var t=location.hash.replace(/^[^#]*#\/*/,"").split("/")[0];if(-1===i.hash.indexOf(t))return void clearTimeout(o)}i.loading?o=setTimeout(arguments.callee,350):(a(s,n),a(s,n)<=i.distance?(i.load(),o=setTimeout(arguments.callee,350)):(n.get(0).onscroll=r,clearTimeout(o)))}},350),a="function"==typeof i.distanceBetweenBottoms?i.distanceBetweenBottoms:function(t,e,i){return i=i||0,(t="string"==typeof t?l(t):t).position().top+t.outerHeight()-i-(e.scrollTop()+e.height())})}}(jQuery),function(c){c.fn.favorite=function(t,e,i){var n=this,s=n.data("favoriteSettings")||c.extend({url:"",onSuccess:function(t){},onFailure:function(t){},serialize:function(t){}},e||{}),o=(n.data("favoriteSettings",s),n.data("favoriteSettingsPrefix")||"favorite-"+(""+Math.random()).slice(2));n.data("favoriteSettingsPrefix",o);function a(t){return t.find('[data-icon="star"]')}var r,l=n.data("favoriteSettingsInitIcon")||function(t){var e=a(t);e.removeClass("star-empty star-hover star loading"),t.hasClass(o+"-loading")?e.addClass("loading"):t.hasClass(o+"-favorite")?e.addClass("text-yellow").removeClass("text-light-gray"):e.removeClass("text-yellow").addClass("text-light-gray")};if(n.data("favoriteSettingsInitIcon",l),"init"!==e)return r=function(t,e){t.removeClass(o+"-loading "+o+"-favorite"),"loading"===e?t.addClass(o+"-loading"):"favorite"===e&&t.addClass(o+"-favorite"),l(t)},n.on("click",t,function(){var t,e,i,n=c(this);"loading"!==((t=n).hasClass(o+"-loading")?"loading":t.hasClass(o+"-favorite")?"favorite":void 0)&&(r(n,"loading"),e=function(t){var e=null;s.onSuccess&&(e=s.onSuccess.apply(n,[t])),r(n,"string"==typeof e?e:"favorite")},i=function(t){s.onFailure&&s.onFailure.apply(n,[t])},c.get(s.url||"",s.serialize(n),"json").success(function(t){t&&"ok"===t.status?e&&e(t):i&&i(t)}).fail(function(t){i&&i(t)}))}),n;n.find(t).each(function(){var t=c(this);a(t).hasClass("star")&&t.addClass(o+"-favorite"),l(c(this))})}}(jQuery),function(t){"use strict";function s(t,e,i){var n=/[^\w\-\.:]/.test(t)?new Function(s.arg+",tmpl","var _e=tmpl.encode"+s.helper+",_s='"+t.replace(s.regexp,s.func)+"';return _s;"):s.cache[t]=!i&&s.cache[t]||s(s.load(t));return e?n(e,s):function(t){return n(t,s)}}s.cache={},s.load=function(t){var e=document.getElementById(t);if(!e&&console)throw{message:"template with id="+t+" not found"};return e?("textarea"==e.tagName.toLowerCase()?e.value:document.getElementById(t).innerHTML).replace(/<\\\/(\w+)/g,"</$1"):null},s.regexp=/([\s'\\])(?![^%]*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,s.func=function(t,e,i,n,s,o){return e?{"\n":"\\n","\r":"\\r","\t":"\\t"," ":" "}[t]||"\\"+t:i?"="===i?"'+_e("+n+")+'":"'+("+n+"||'')+'":s?"';":o?"_s+='":void 0},s.encReg=/[<>&"'\x00]/g,s.encMap={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},s.encode=function(t){return String(t||"").replace(s.encReg,function(t){return s.encMap[t]||""})},s.arg="o",s.helper=",print=function(s,e){_s+=e&&(s||'')||_e(s);},include=function(s,d){_s+=tmpl(s,d);}","function"==typeof define&&define.amd?define(function(){return s}):t.tmpl=s}(this),$.fn.liveDraggable=function(e){this.each(function(t,e){var i=$(this);i.data("init_draggable")&&i.off("mouseover",i.data("init_draggable"))}),this.off("mouseover").on("mouseover",function(){var t=$(this);t.data("init_draggable")||t.data("init_draggable",arguments.callee).draggable(e)})},$.fn.liveDroppable=function(e){this.each(function(t,e){var i=$(this);i.data("init_droppable")&&i.off("mouseover",i.data("init_droppable"))});function t(){var t=$(this);t.data("init_droppable")||(t.data("init_droppable",arguments.callee).droppable(e),t.mouseover())}t.call(this),this.off("mouseover",t).on("mouseover",t)},jQuery,$.fn.filesDialog=function(t){if("function"==typeof(t=t||{}).onFirstLoad){const e=t.onOpen||function(){},i=t.onFirstLoad;t.onOpen=function(){var t=Array.prototype.slice.call(arguments);e.counter=e.counter||0,e.counter||i.apply(this,t),e.apply(this,t),e.counter+=1}}$.waDialog({$wrapper:this,...t})},function(r){"use strict";r.widget("wa.fileupload",r.blueimp.fileupload,{options:{autoUpload:!1,maxNumberOfFiles:void 0,limitConcurrentUploads:1,maxFileSize:void 0,minFileSize:1,acceptFileTypes:/.*$/i,previewFileTypes:/^image\/(gif|jpeg|png)$/,previewMaxFileSize:5e6,previewMaxWidth:80,previewMaxHeight:80,previewAsCanvas:!0,dataType:"json",add:function(t,e){var i=r(this).data("fileupload"),n=e.files,s=i.dialog;s.is(":hidden")&&s.trigger("openUploader"),i._adjustMaxNumberOfFiles(-n.length),e.isAdjusted=!0,e.files.valid=e.isValidated=i._validate(n),e.context=i._renderUpload(n).appendTo(i._files).data("data",e),i._reflow=i._transition&&e.context[0].offsetWidth,e.context.addClass("in"),(i.options.autoUpload||e.autoUpload)&&e.isValidated&&e.submit(),(s=i.dialog).data("step2xhr").done(function(){var t=i._files.children().length,e=r(".f-upload-step2 h3",s);e.find(".f-title").html(e.data("tmpl").replace("%d",t)),r(".f-upload-step1",s).fadeOut(4),r(".f-upload-step1-buttons",s).hide(),r(".f-upload-step2",s).show(),r(".f-upload-step2-buttons",s).show(),r(".f-upload-step2",s).find(".f-access-denied").length&&r(".f-upload-step2-buttons",s).find(".start").attr("disabled",!0)})},send:function(t,e){var i=r(this).data("fileupload");if(!e.isValidated&&(e.isAdjusted||i._adjustMaxNumberOfFiles(-e.files.length),!i._validate(e.files)))return!1;e.context&&e.dataType&&"iframe"===e.dataType.substr(0,6)&&e.context.find(".progressbar-inner").css("width","100%")},submit:function(t,e){r(this).data("data",e)},done:function(t,i){var n,s=r(this),o=s.data("fileupload"),e=i.originalFiles.length;i.context?i.context.each(function(t){var e=i.result&&r.isArray(i.result.files)&&i.result.files[t]||{error:$_("Empty result")};e.error&&o._adjustMaxNumberOfFiles(1),s.data("result",i.result),o._transitionCallback(r(this).removeClass("in"),function(t){o.filesCount++,(n=o._renderDownload([e])).replaceAll(t),o._reflow=o._transition&&n[0].offsetWidth,n.addClass("in"),e.error||(o.filesIds.push(e.id),setTimeout(function(){n.hide(200)},5e3))})}):e==o.filesCount&&o.dialog.find(".js-close-dialog").trigger("click")},fail:function(t,i){var n,s=r(this).data("fileupload");s._adjustMaxNumberOfFiles(i.files.length),i.context?i.context.each(function(t){var e;"abort"!==i.errorThrown?((e=i.files[t]).error=e.error||i.errorThrown||!0,"object"!=typeof i.jqXHR||i.jqXHR||(e.responseText=i.jqXHR.responseText),s._transitionCallback(r(this).removeClass("in"),function(t){n=s._renderDownload([e]).replaceAll(t),s._reflow=s._transition&&n[0].offsetWidth,n.addClass("in")})):s._transitionCallback(r(this).removeClass("in"),function(t){t.remove()})}):"abort"!==i.errorThrown&&(s._adjustMaxNumberOfFiles(-i.files.length),i.context=s._renderUpload(i.files).appendTo(s._files).data("data",i),s._reflow=s._transition&&i.context[0].offsetWidth,i.context.addClass("in"))},progress:function(t,e){e.context&&e.context.find(".progressbar-inner").css("width",parseInt(e.loaded/e.total*90,10)+"%")},progressall:function(t,e){e=parseInt(e.loaded/e.total*95,10)+"%";r(this).find(".f-fileupload-progressbar").css("width",e),r(".f-upload-filescount").html(e)},start:function(t,e){var i=r(this),n=(i.data("dialog")?.resize(),i.data("fileupload"));n.filesCount=0,n.filesIds=[],r(".f-upload-step2",i).hide(),r(".f-upload-step2-buttons",i).hide(),r(".f-upload-step3",i).show(),r(".f-upload-step3-buttons",i).show(),r(".f-upload-step3-buttons .cancel",i).show(),r(".f-fileupload-progressbar",i).css("width","0%"),r(".f-upload-step3-buttons .f-progressbar",i).show(),r(".f-upload-step3-buttons .cancel",i).text($_("Stop upload")),r(".f-upload-error",i).hide()},stop:function(t){var e,i=r(this),n=i.data("fileupload"),s=n.filesCount,n=n.dialog;r(".f-upload-filescount",i).html("100%"),r(".f-fileupload-progressbar",i).css({width:"100%"}),i.data("is_error")&&(r(".f-upload-step3-buttons .progressbar",i).hide(),r(".f-upload-filescount",i).hide(),r(".f-upload-error",i).show()),i.data("is_error")||i.data("is_aborted")||((e=i.data("result")).files_count=s,n.trigger("finishUploader",[e])),i.data("is_error",!1),i.data("is_aborted",!1),r(".f-upload-step3-buttons .cancel",n).text($_("Close"))},destroy:function(t,e){var i=r(this).data("fileupload");e.url&&r.ajax(e),i._adjustMaxNumberOfFiles(1),i._transitionCallback(e.context.removeClass("in"),function(t){t.remove()})}},_enableDragToDesktop:function(){var t=r(this),e=t.prop("href"),i=decodeURIComponent(e.split("/").pop()).replace(/:/g,"-");t.bind("dragstart",function(t){try{t.originalEvent.dataTransfer.setData("DownloadURL",["application/octet-stream",i,e].join(":"))}catch(t){}})},_adjustMaxNumberOfFiles:function(t){"number"==typeof this.options.maxNumberOfFiles&&(this.options.maxNumberOfFiles+=t,this.options.maxNumberOfFiles<1?this._disableFileInputButton():this._enableFileInputButton())},_formatFileSize:function(t){return r.files.formatFileSize(t)},_formatBitrate:function(t){return"number"!=typeof t?"":1e9<=t?(t/1e9).toFixed(2)+" Gbit/s":1e6<=t?(t/1e6).toFixed(2)+" Mbit/s":1e3<=t?(t/1e3).toFixed(2)+" kbit/s":t+" bit/s"},_formatTime:function(t){var e=new Date(1e3*t),t=parseInt(t/86400,10);return(t?t+"d ":"")+("0"+e.getUTCHours()).slice(-2)+":"+("0"+e.getUTCMinutes()).slice(-2)+":"+("0"+e.getUTCSeconds()).slice(-2)},_formatPercentage:function(t){return(100*t).toFixed(2)+" %"},_renderExtendedProgress:function(t){return this._formatBitrate(t.bitrate)+" | "+this._formatTime(8*(t.total-t.loaded)/t.bitrate)+" | "+this._formatPercentage(t.loaded/t.total)+" | "+this._formatFileSize(t.loaded)+" / "+this._formatFileSize(t.total)},_hasError:function(t){return t.error||(this.options.maxNumberOfFiles<0?"maxNumberOfFiles":this.options.acceptFileTypes.test(t.type)||this.options.acceptFileTypes.test(t.name)?this.options.maxFileSize&&t.size>this.options.maxFileSize?"maxFileSize":"number"==typeof t.size&&t.size<this.options.minFileSize?"minFileSize":null:"acceptFileTypes")},_validate:function(t){var i=this,n=!!t.length;return r.each(t,function(t,e){e.error=i._hasError(e),e.error&&(n=!1)}),n},_renderTemplate:function(t,e){return r(this.options.templateContainer).html(t({files:e,formatFileSize:this._formatFileSize,options:this.options})).children()},_renderUpload:function(t){return this._renderTemplate(this.options.uploadTemplate,t)},_renderDownload:function(t){for(var e=this.element,i=this._renderTemplate(this.options.downloadTemplate,t),n=0;n<t.length;n++)if(t[n].error){e.data("is_error",!0);break}return i.find("a").each(this._enableDragToDesktop),i},_startHandler:function(t){t.preventDefault();var t=r(this),e=t.closest(".f-template-upload").data("data");e&&e.submit&&!e.jqXHR&&e.submit()&&t.prop("disabled",!0)},_cancelHandler:function(t){t.preventDefault();var e=r(this).closest(".f-template-upload").data("data")||{};e.jqXHR?(r(t.data.fileupload.element[0]).data("is_aborted",!0),e.jqXHR.abort()):(e.errorThrown="abort",t.data.fileupload._trigger("fail",t,e))},_deleteHandler:function(t){t.preventDefault();var e=r(this);t.data.fileupload._trigger("destroy",t,{context:e.closest(".template-download"),url:e.attr("data-url"),type:e.attr("data-type"),dataType:t.data.fileupload.options.dataType})},_transitionCallback:function(e,i){var n=this;this._transition&&e.hasClass("fade")?e.bind(this._transitionEnd,function(t){t.target===e[0]&&(e.unbind(n._transitionEnd),i.call(n,e))}):i.call(this,e)},_initTransitionSupport:function(){var t=(document.body||document.documentElement).style,e="."+this.options.namespace;this._transition=void 0!==t.transition||void 0!==t.WebkitTransition||void 0!==t.MozTransition||void 0!==t.MsTransition||void 0!==t.OTransition,this._transition&&(this._transitionEnd=["TransitionEnd","webkitTransitionEnd","transitionend","oTransitionEnd"].join(e+" ")+e)},_initButtonBarEventHandlers:function(){var s=this,t=s.element.find(".dialog-footer"),o=s._files,a=s.dialog,e=this.options.namespace;t.find(".start").bind("click."+e,function(t){t.preventDefault();function e(){var t=r(".f-upload-step2 .f-upload-step-main-content",a).find("[name=folder_id]");return t.length?t.val()||"":r.files.controller.getCurrentFolderId()}function i(){var t=r(".f-upload-step2 .f-upload-step-main-content",a).find("[name=storage_id]");return t.length?t.val()||"":r.files.controller.getPreviousStorageId()}r.wa.fn={getStorageId:i,getFolderId:e};var t=s._fileNames,n=r(".f-upload-step2 .f-upload-step-name-conflict-content",a);n.find("[name=solve]").length?o.find(".start").click():r.get("?module=upload&action=nameConflict",{folder_id:e(),storage_id:i(),file_names:t},function(t){t=r("<div>").html(t);t.find(".f-conflict-files").children().length?(n.html(t.html()),t.remove()):o.find(".start").click(),s.dialog.data("dialog").resize()})}),t.find(".cancel").bind("click."+e,function(t){t.preventDefault(),o.find(".cancel").click()}),t.find(".delete").bind("click."+e,function(t){t.preventDefault(),o.find(".delete input:checked").siblings("button").click()}),t.find(".toggle").bind("change."+e,function(t){o.find(".delete input").prop("checked",r(this).is(":checked"))})},_destroyButtonBarEventHandlers:function(){this.element.find(".fileupload-buttonbar button").unbind("click."+this.options.namespace),this.element.find(".fileupload-buttonbar .toggle").unbind("change."+this.options.namespace)},_initEventHandlers:function(){r.blueimp.fileupload.prototype._initEventHandlers.call(this);var t={fileupload:this};this._files.delegate(".start","click."+this.options.namespace,t,this._startHandler).delegate(".cancel","click."+this.options.namespace,t,this._cancelHandler).delegate(".delete button","click."+this.options.namespace,t,this._deleteHandler),this._initButtonBarEventHandlers(),this._initTransitionSupport()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers(),this._files.undelegate(".start","click."+this.options.namespace).undelegate(".cancel","click."+this.options.namespace).undelegate(".delete button","click."+this.options.namespace),r.blueimp.fileupload.prototype._destroyEventHandlers.call(this)},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!1).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!0).parent().addClass("disabled")},_initTemplates:function(){this.options.templateContainer=document.createElement(this._files.prop("nodeName")),this.options.uploadTemplate=window.tmpl("f-template-upload"),this.options.downloadTemplate=window.tmpl("f-template-download")},_onDrop:function(e){e.preventDefault();var i=e.data.fileupload,t=i.dialog;r(".f-upload-step3",t).is(":visible")||void 0!==(t=e.dataTransfer=e.originalEvent.dataTransfer)&&i._getFilesFromDataTransfer(t).done(function(t){t={files:r.each(t,i._normalizeFile)};!1!==i._trigger("drop",e,t)&&i._onAdd(e,t)})},_getFilesFromDataTransfer:function(t){return this._isWebkitGetAsEntrySupport()?this._getFilesUseWebkitGetAsEntry(t):this._isFileReaderSupport()?this._getFilesUseFileReader(t):this._getFilesBySimpleCheck(t)},_isWebkitGetAsEntrySupport:function(){return"undefined"!=typeof DataTransferItem&&void 0!==DataTransferItem.prototype.webkitGetAsEntry},_isFileReaderSupport:function(){return"undefined"!=typeof FileReader},_getFilesUseWebkitGetAsEntry:function(t){for(var e=r.Deferred(),i=[],n=0;n<t.files.length;n+=1){var s=t.items&&t.items[n];s&&s.webkitGetAsEntry().isDirectory||i.push(t.files[n])}return e.resolve(i),e.promise()},_getFilesUseFileReader:function(t){for(var e=[],i=0;i<t.files.length;i+=1){var n=t.files[i],s=r.Deferred();if(e.push(s),n.type&&n.size%4096!=0)s.resolve({file:n,is_dir:!1});else try{!function(t,e){var i=new FileReader;i.readAsArrayBuffer(t),i.onload=function(){e.resolve({file:t,is_dir:!1})},i.onerror=function(){e.resolve({file:t,is_dir:!0})}}(n,s)}catch(t){s.resolve({file:n,is_dir:!0})}}s=r.Deferred();return r.when.apply(r,e).done(function(){for(var t=[],e=0;e<arguments.length;e+=1)arguments[e].is_dir||t.push(arguments[e].file);s.resolve(t)}),s.promise()},_getFilesBySimpleCheck:function(t){for(var e=r.Deferred(),i=[],n=0;n<t.files.length;n+=1)file.type&&file.size%4096!=0&&i.push(t.files[n]);return e.resolve(i),e.promise()},_onAdd:function(t,e){r.blueimp.fileupload.prototype._onAdd.call(this,t,e);var i=[];r.each(e.files,function(t,e){i.push(e.name)}),t.data.fileupload._fileNames=i},_initFiles:function(){this._files=this.element.find(".files")},_create:function(){this._initFiles(),r.blueimp.fileupload.prototype._create.call(this),this._initTemplates(),this.dialog=this.options.dialog},destroy:function(){r.blueimp.fileupload.prototype.destroy.call(this)},enable:function(){r.blueimp.fileupload.prototype.enable.call(this),this.element.find("input, button").prop("disabled",!1),this._enableFileInputButton()},disable:function(){this.element.find("input, button").prop("disabled",!0),this._disableFileInputButton(),r.blueimp.fileupload.prototype.disable.call(this)}})}(jQuery),function(t){var e,i;t(document).on("dragstart",function(){e=!0}).on("dragover",function(){e||(i?clearTimeout(i):t("#wa").addClass("file-hover"),i=setTimeout(function(){t("#wa").removeClass("file-hover"),i=null,e=!1},100))}).on("dragend",function(){e=!1})}(jQuery),function(c){c.files=c.extend(c.files||{},{init:function(t){this.config.init(t.config||{}),this.runBackgroundTasks(),new Sidebar(c("#f-sidebar")),c.files.controller.init(),history.back&&c("body").on("click",".f-back-to-list",function(){history.back()}),c.wa.errorHandler=function(t){return c.files.getXWaFilesLocation(t)||c.files.getXWaFilesSourceStatus(t)?(c.wa.dialogHide(),!1):403===t.status?(c.files.alert403Error(t.responseText),!1):void 0},c(document).ajaxComplete(function(t,e){return c.files.getXWaFilesLocation(e)?(window.location.href=c.files.getXWaFilesLocation(e),c(".dialog").hide(),!1):(e=c.files.getXWaFilesSourceStatus(e))?(c(".dialog").hide(),"in-pause"===e?c.files.alertError($_("Too many requests to external source service. Please try again in a few minutes.")):c.files.alertError($_("Server error")),!1):void 0})},load:function(t,s,e){e=e||{};function i(t){var e=c(".f-load-block",a).first();if(r.hide(),o===c.files.load_protector){var i=c("<div></div>").html(t),n=i.find(".h-main-title").text();if(n&&c.files.setBrowserTitle(n),i.remove(),e.html(t),s)try{s.call(this)}catch(t){}c(window).trigger(c.Event("wa_loaded"))}}var o=c.files.load_protector=Math.random(),a=c.files.config.getMainContainer(),r=(e.container&&("string"===c.type(e.container)&&c(e.container).length||e.container.length)&&(a=c(e.container)),c(".f-loading",a).show()),n=c.files.load.onSuccess||i,l=c.files.load.onError||function(t){i(t.responseText)};c.get(t).success(function(t,e,i){c.files.getXWaFilesLocation(i)||c.files.getXWaFilesSourceStatus(i)||n&&n(t)}).error(function(t,e,i){c.files.getXWaFilesLocation(t)||c.files.getXWaFilesSourceStatus(t)||l&&l(t)}).always(function(t,e,i){c.files.getXWaFilesLocation(i)||c.files.getXWaFilesSourceStatus(i)})},alert403Error:function(t){c.waDialog.alert({text:t,button_title:"Ok",button_class:"warning"})},alertError:function(t,e){c.waDialog.alert({text:t,button_title:"Ok",button_class:"warning"}),e&&this.logError(e)},alertInfo:function(t){c.waDialog.alert({text:t,button_title:"Ok",button_class:"warning"})},getXWaFilesLocation:function(t){return t&&t.getResponseHeader&&t.getResponseHeader("X-Wa-Files-Location")||""},getXWaFilesSourceStatus:function(t){return t&&t.getResponseHeader&&t.getResponseHeader("X-Wa-Files-Source-Status")||""},confirmDelete:function(t,e,i){c.isPlainObject(t)&&(t.btn_text=$_("Delete")),this.confirm(t,e,i)},confirm:function(t,e,i){let n="",s=$_("Yes");return c.isPlainObject(t)&&(n=t.title||"",s=t.btn_text||$_("Yes"),t=t.msg||""),c.waDialog.confirm({title:n,text:t,success_button_title:s,success_button_class:"danger",cancel_button_title:$_("Cancel"),cancel_button_class:"light-gray",onSuccess(t){e&&e.apply(c(this))},onCancel(t){i&&i.apply(c(this))}})},jsonPost:function n(s,t,o,a,r){var e;return 1===arguments.length&&c.isPlainObject(s)&&(s=(e=s).url||"",t=e.data||"",o=e.onSuccess,a=e.onError||e.onFailure||e.onFail,r=e.onAlways),(t=c.isEmptyObject(t)?{}:t)._timestamp=Date.now(),(n.run=n.run||{})[s]||(e=c.post(s,t,function(t,e,i){c.files.getXWaFilesLocation(i)||c.files.getXWaFilesSourceStatus(i)||(t?o&&o(t):a&&a())},"json").error(function(t){c.files.getXWaFilesLocation(t)||c.files.getXWaFilesSourceStatus(t)||403!=t.status&&a&&a(t)}).always(function(t,e,i){delete n.run[s],c.files.getXWaFilesLocation(i)||c.files.getXWaFilesSourceStatus(i)||r&&r(t)}),n.run[s]=e),n.run[s]},showValidateErrors:function(t,i){c.each(t,function(t,e){i.find('[name="'+e.name+'"]').addClass("state-error").parent().append('<span class="state-error-hint">'+e.msg+"</span>")})},onFormChange:function(e,i){var t=e.find(":input"),n=(t.on("change.files_form_change",function(){i.apply(e,[this])}),t.filter("select").on("click.files_form_change",function(){i.apply(e,[this])}),null);t.filter("textarea,input[type=text]").on("keydown.files_form_change",function(){n&&(clearTimeout(n),n=null);var t=this;n=setTimeout(function(){i.apply(e,[t])},250)})},offFormChange:function(t){t.find(":input,:select").off(".file_form_change")},clearValidateErrors:function(t){t.find(".state-error-hint").remove().end().find(".state-error").removeClass("state-error")},initLazyLoad:function(i){var n=i.count,s=i.total_count,t=i.url,o=c(i.container),a=void 0===i.auto||i.auto,r=c(window);r.lazyLoad("stop"),n<s&&(r.lazyLoad({container:o,state:a?"wake":"stop",load:function(){r.lazyLoad("sleep"),c(".f-lazyloading-link").hide(),c(".f-lazyloading-progress").show(),c.get(t+"&lazy=1&offset="+n+"&total_count="+s,function(t){var t=c("<div></div>").html(t),e=t.find(".f-catalog-item");!e.length||(n+=e.length,c(".f-catalog-wrapper",o).append(e),s<=n)?(r.lazyLoad("stop"),c(".f-lazyloading-progress").hide()):(r.lazyLoad("wake"),c(".f-lazyloading-link").show(),a||c(".f-lazyloading-progress").hide()),c(".f-lazyloading-progress-string",o).replaceWith(c(".f-lazyloading-progress-string",t)),c(".f-lazyloading-chunk",o).replaceWith(c(".f-lazyloading-chunk",t)),t.remove(),i.onLoad&&i.onLoad(),c.files.retina()})}}),o.on("click",".lazyloading-link",function(){return c(window).lazyLoad("force"),!1}))},refreshSidebar:function t(){var i,e,n;if(!t.load)return t.load=!0,i=c.files.config.getSidebar(),e=i.find(".selected"),n=(e.attr("class")||"").split(/\s+/).join("."),c.get("?module=backend&action=sidebar&is_reload=1",function(t){var e=i.find(".sidebar-mobile-toggle").detach();i.html(t),i.prepend(e),i.find(".sidebar-header").css("display",""),i.find(".sidebar-body").css("display",""),i.find(".sidebar-footer").css("display",""),i.find("a").not(".sidebar-mobile-toggle a").on("click",function(){c(".sidebar-mobile-toggle").trigger("click")})}).always(function(){t.load=!1,(e=n?i.find(n):c()).length?e.addClass("selected"):c.files.config.getSidebar().trigger("notify",{hash:c.files.controller.getCurrentHash()})})},setBrowserTitle:function(t,e){e=e?"":"  "+this.config.getAccountName();document.title=t+e},iButton:function(t,e){e=c.extend({labelOn:"",labelOff:"",className:"mini"},e||{});return t.iButton(e),t},moveFiles:function(t){var i=t.file_ids||[],n=t.storage_id||0,s=t.folder_id||0,o=t.is_restore||"",a=t.onFailure||t.onError||t.onFail,e=t.onAlways,r=t.onSuccess,t=t.beforeMoveFiles;if(n&&c.files.controller.getCurrentStorageId()===n||s&&c.files.controller.getCurrentFolderId()===s)return a&&a({same_place:!0}),!1;t&&t(),c.files.jsonPost({url:"?module=move&action=files"+(o?"&restore=1":""),data:{folder_id:s,storage_id:n,file_id:i},onSuccess:function(t){var e;t&&"ok"===t.status&&t.data&&t.data.success?r&&r(t):t&&t.data&&t.data.unallowed_exist?(e=c.map(i,function(t){return"file_id[]="+t}).join("&"),c.files.loadDialog("?module=move&"+e+"&storage_id="+n+"&folder_id="+s)):t&&t.data&&t.data.files_conflict?(e=c.map(i,function(t){return"file_id[]="+t}).join("&"),c.files.loadDialog("?module=move&action=nameConflict&"+e+"&storage_id="+n+"&folder_id="+s+(o?"&restore=1":""))):t&&t.data?a(t.data):t&&t.errors?a(t.errors):a()},onFailure:function(t){a(t)},onAlways:function(){e&&e()}})},filterSettingsFormSubmit:function(e,t){c.files.clearValidateErrors(e);function i(t){c.files.alertError($_("Couldn't save filter"),t)}const n=(t=t||{}).onSuccess,s=t.onAlways||null;c.files.jsonPost({url:"?module=filter&action=save",data:e.serialize(),onSuccess:function(t){"ok"!==t.status?c.files.showValidateErrors(t.errors,e):t.data.filter?(c.files.controller.gotoFilterPage(t.data.filter.id),c.files.refreshSidebar(),n&&n()):i(t.data)},onFailure:i,onAlways:function(){s&&s()}})},storageSettingsFormSubmit:function(e,i){if(e.data("loading"))return!1;e.data("loading",1),e.find(".fa-spinner").removeClass("hidden"),e.find('[type="submit"]').attr("disabled",!0),c.files.clearValidateErrors(e);const n=(i=i||{}).onSuccess,t=i.onAlways,s=t=>{403!==t.status&&c.files.alertError($_("Couldn't create storage"),t)};c.files.jsonPost({url:"?module=storage&action=save",data:e.serialize(),onSuccess:function(t){"ok"!==t.status?c.files.showValidateErrors(t.errors,e):t.data.storage?(!1!==i.reload&&c.files.controller.gotoStoragePage(t.data.storage.id),c.files.refreshSidebar(),n&&n()):s(t.data)},onFailure:s,onAlways:function(){e.data("loading",0),e.find(".fa-spinner").addClass("hidden"),e.find('[type="submit"]').attr("disabled",!1),t&&t()}})},showNotificationMessage:function(t,e){function i(t){t.animate({height:0},500,function(){c(this).remove()})}c(".f-notification-message").length&&i(c(".f-notification-message"));var n=c("<div>").addClass("f-notification-message block double-padded").css({display:"none",position:"fixed",width:200,bottom:0,right:0,height:0,backgroundColor:e||"#FEF49C",border:"2px solid #DDD"});n.append("<p>"+t+"</p>"),n.appendTo(c("body")),n.show().animate({height:20},500),setTimeout(function(){i(n)},1500)},loadDialog:function e(i,n){(e.load=e.load||{})[i]||(e.load[i]=!0,c.get(i,function(t){e.load[i]=!1,c(t).filesDialog(n||{})}).error(function(t){403===t.status&&c.files.alert403Error(t.responseText)}))},parseFileName:function(t){var e="",i=t.lastIndexOf(".");return 0<i&&(e=t.slice(i+1),t=t.slice(0,i)),{filename:t,ext:e}},retina:function(){c.Retina&&c("#wa-app").find("img:not(.f-retina-off)").addClass("f-retina-off").retina()},loc:function(t,e){var i=$_(t,e)||"";return i=e?i.replace("%d",t):i},ucfirst:function(t){return(t=t||"")?t.slice(0,1).toUpperCase()+t.slice(1):""},lcfirst:function(t){return(t=t||"")?t.slice(0,1).toLowerCase()+t.slice(1):""},logError:function(t){console&&(console.error?console.error(t):console.log(t))},runCopyFiles:function(){if(c.files.config.canRunCopyFiles()){var t=Math.floor(100*Math.random())/100,e={id:(""+Math.random()).slice(2),delay:1e4+5e3*t,timer:null,xhr:null};try{e.timer&&clearTimeout(e.timer),e.xhr&&e.xhr.abort();function i(){c.files.config.canRunCopyFiles()?(console.log("copytask ["+e.id+"] start"),e.xhr=c.files.jsonPost("?module=copy&action=task&background_process=1&process_id="+e.id),e.xhr.always(function(){e.xhr=null,e.timer=setTimeout(i,e.delay),console.log("copytask ["+e.id+"] end")}),e.xhr.error(function(){return!1})):(e.timer&&clearTimeout(e.timer),e.xhr&&e.xhr.abort())}i(),e.timer=setTimeout(i,e.delay)}catch(t){console.error(["runCopyFiles fail",t])}}},checkBackendChanges:function(e){var a=c.files.controller.getCurrentHash(2),i=a.split("/"),t=c.files.config.getHashesForChangeListener(),n=!1;if(c.each(t,function(t,e){if(i[0]==e)return!(n=!0)}),n){let t="?module=backend&action=changes";return e&&(t+="&background_process=1"),c.files.jsonPost(t,{hash:a}).done(function(t){var e,i,n,s,o;"ok"===t.status&&(e=function(t){return new Date(t||"1970-01-01").getTime()},t=t.data,i=t.info,s=null===(o=c.files.config.getPageInfo(a))&&null!==i||null!==o&&null===i,o=o||{},i=i||{},s||(n=e(i.update_datetime),e(o.update_datetime)<n&&(s=!0)),s||i.count!=o.count&&(s=!0),s||i.size!=o.size&&(s=!0),c.files.config.setPageInfo(a,i),s)&&0<t.info?.count&&(c.files.controller.reloadPage(),c.files.refreshSidebar())}).error(function(){return!1})}},peformTasks:function(){return c.files.jsonPost("?module=backend&action=tasksPerform&background_process=1")},runTasksPerformer:function(){try{var t=1e4+5e3*(Math.floor(100*Math.random())/100),e=this.peformTasks,i=(e.timer&&(clearTimeout(e.timer),e.xhr.abort()),e.delay=t,function(){e.xhr||(e.xhr=c.files.peformTasks().always(function(){e.xhr=null,e.timer=setTimeout(i,e.delay)}))});i()}catch(t){console.error(["runTasksPerformer fail",t])}},runBackendChanges:function(){try{var t=3e4+5e3*(Math.floor(100*Math.random())/100),e=this.runBackendChanges,i=(e.timer&&(clearTimeout(e.timer),e.xhr.abort()),e.delay=t,function(){e.xhr||(e.xhr=c.files.checkBackendChanges(!0),e.xhr?e.xhr.always(function(){e.xhr=null,e.timer=setTimeout(i,e.delay)}):(e.xhr=null,e.timer=setTimeout(i,e.delay)))});i()}catch(t){console.error(["runBackendChanges fail",t])}},runSyncWithSources:function(){if(!(this.config.getSourceCount()<=0&&this.runSyncWithSources.work)&&c.files.config.canRunSyncWithSources()){this.runSyncWithSources.work=!0;try{var t=1e4+5e3*(Math.floor(100*Math.random())/100),i=this.runSyncWithSources,n=(i.timer&&(clearTimeout(i.timer),i.xhr)&&i.xhr.abort(),i.delay=t,function(){var t,e;0<=(location.hash||"").replace(/(^[^#]*#\/*|\/$)/g,"").indexOf("source/")?(i.xhr=null,i.timer=setTimeout(n,i.delay)):i.paused||i.xhr||(c.files.config.canRunSyncWithSources()?(t=parseInt(c.files.controller.getCurrentFolderId(),10)||0,e=parseInt(c.files.controller.getCurrentStorageId(),10)||0,i.xhr=c.files.jsonPost("?module=source&action=sync&background_process=1",{folder_id:t,storage_id:e}),i.xhr.done(function(t){var e;"ok"===t.status&&t.data&&t.data.hasOwnProperty("source_id")&&0<(e=c.files.config.getSourceId())&&t.data.source_id===e&&c.files.controller.reloadPage()}).always(function(){i.xhr=null,i.timer=setTimeout(n,i.delay)}).error(function(){return!1})):(i.timer&&clearTimeout(i.timer),i.xhr&&i.xhr.abort()))});n(),i.pause=function(){i.paused=!0},i.unpause=function(){i.paused=!1}}catch(t){this.runSyncWithSources.work=!1,console.error(["runSyncWithSources fail",t])}}},runBackgroundTasks:function(){for(var t=[this.runTasksPerformer,this.runCopyFiles,this.runSyncWithSources,this.runBackendChanges],e=[],i=0;i<t.length;i+=1)if(c.isArray(t[i]))for(var n=t[i][0],s=t[i][1],o=0;o<s;o+=1)e.push(n);else e.push(t[i]);for(t=(t=e).sort(function(){return Math.random()-Math.random()}),i=0;i<t.length;i+=1)!function(t){var e=Math.floor(100*Math.random())/100;setTimeout(function(){t.apply(c.files)},500*e)}(t[i])},deleteSource:function(t){return c.files.jsonPost({url:"?module=source&action=delete",data:{id:t},onSuccess:function(t){"ok"===t.status&&(c.files.refreshSidebar(),c.files.controller.gotoDefaultPage())}})},formatFileSize:function(t){return"number"!=typeof t?"":1e9<=t?c.files.formatNumber(t/1e9,2)+" "+$_("GB"):1e6<=t?c.files.formatNumber(t/1e6,2)+" "+$_("MB"):c.files.formatNumber(t/1e3,2)+" "+$_("KB")},formatNumber:function(t,e){var i;return"number"!=typeof t?"":(i="",i="number"==typeof e?t.toFixed(e):""+t,"ru_RU"===c.files.config.getLocale()?i.replace(".",","):i)},detectFlexWrap(t,n="is-wrapped"){const e=t=>{let e=0,i=!0;[...t.children].forEach(t=>{(!t.previousElementSibling||t.offsetLeft<t.previousElementSibling.offsetLeft)&&(e++,i=!i),t.classList.toggle(n,i)}),t.classList.toggle("has-wrapped",1<e)};var i=new ResizeObserver(t=>{t.forEach(t=>{e(t.target)})}),t=document.querySelector(t);i.observe(t),e(t)}})}(jQuery),function(n){n.files=n.files||{},n.files.config={init:function(t){var e,i=t||{};for(e in i)if(i.hasOwnProperty(e)){this["__"+e]=i[e];for(var n=e.split("_"),s="get",o=0;o<n.length;o+=1)s+=n[o].slice(0,1).toUpperCase()+n[o].slice(1);this[s]||!function(t,e){e[s]=function(){return this["__"+t]}}(e,this)}},set:function(t,e){var i;n.isPlainObject(t)?this.init(t):((i={})[t]=e,this.init(i))},getLocaleStorage:function(){return this.__storage=this.__storage||new n.store,this.__storage},getLocale:function(){return this.__locale=this.__locale||"en_US",this.__locale},getSidebar:function(){return n("#"+this.__sidebar_id)},getMainContainer:function(){return n("#"+this.__main_container_id)},getFileList:function(){return n("#"+this.__file_list_id)},getStatisticsContainer:function(){return n("#"+this.__statistics_container_id)},setSourceId:function(t){this.__source_id=t},getSourceId:function(){return this.__source_id||0},getSourceCount:function(){return this.__source_count||0},setSourceCount:function(t){this.__source_count=parseInt(t,10)||0},canRunCopyFiles:function(t){return void 0===this.__can_run_copy_files&&(this.__can_run_copy_files=!0),void 0!==t&&(this.__can_run_copy_files=t),this.__can_run_copy_files},canRunSyncWithSources:function(t){return void 0===this.__can_run_sync_with_sources&&(this.__can_run_sync_with_sources=!0),void 0!==t&&(this.__can_run_sync_with_sources=t),this.__can_run_sync_with_sources},setPageInfo:function(t,e){this._list_info=this._list_info||{},this._list_info[t]=this._list_info[t]||{},this._list_info[t]=n.extend(this._list_info[t],e)},getPageInfo:function(t){return this._list_info=this._list_info||{},this._list_info[t]=this._list_info[t]||{},this._list_info[t]}}}(jQuery);var Sidebar=function(e){return(Sidebar=function(t){e.isPlainObject(t)||(t={$sidebar:t||e()}),this.$sidebar=t.$sidebar||!1,this.initSidebar()}).prototype.initSidebar=function(){this.bindEvents()},Sidebar.prototype.bindEvents=function(){var t=this.$sidebar;t.on("click","ul li a",function(){t.find(".selected").removeClass("selected"),e(this).closest("li").addClass("selected")})},Sidebar}(jQuery),File=function(h){return(File=function(t){var e=this;e.$file=t.$file,e.file_id=t.file_id,e.can_rename=t.can_rename,e.can_edit_tags=t.can_edit_tags,e.can_comment=t.can_comment,e.full_access=t.full_access,e.marks=t.marks?.filter(Boolean),e.locale=t.locale,e.initFile()}).prototype.initFile=function(){var t=this;t.bindEvents(),t.initTags(),t.can_rename&&t.initHeaderRename(),t.can_comment&&t.initComments(),t.full_access&&setTimeout(t.initMarkControl.bind(t),500),t.initFrontUrl()},File.prototype.bindEvents=function(){var t=this,e=t.$file;h(".f-in-sync").on("click",function(){return alert($_("Sync is in process. No changes available until synchronization finish.")),!1}),h("#f-share-link").on("click",function(){h.files.loadDialog("?module=share&file_id="+t.file_id)}),h("#f-public-link").on("click",function(){h.files.loadDialog("?module=share&public_link=1&file_id="+t.file_id)}),e.on("click",".f-delete-file:not(.f-in-sync)",function(){h.files.loadDialog("?module=delete&file_id[]="+t.file_id+"&from=fileinfo")}),e.on("click",".f-send-file",function(){h.files.loadDialog("?module=send&file_id[]="+t.file_id+"&from=fileinfo")})},File.prototype.initTags=function(){var t=this,e=t.$file.find(".f-tags-wrapper"),i=e.find("#f-file-tags"),n=t.$file.find(".f-popular-tags"),s=e.find(".saved-link"),o=e.data("add-tag-text")||"enter tags",a=t.can_edit_tags,r="is-shown",l={autocomplete_url:"",interactive:a,removeWithBackspace:!1,defaultText:""};function c(){s.hasOwnProperty("timeout")&&s.timeout&&clearTimeout(s.timeout),s.addClass(r),s.timeout=setTimeout(function(){s.removeClass(r),s.timeout=!1},500)}n.on("click","a",function(){var t=h(this).text();i.removeTag(t),i.addTag(t)}),a?l=h.extend(l,{defaultText:o,autocomplete:{source:function(t,e){h.getJSON("?module=tag&action=autocomplete&term="+t.term,function(t){"ok"===t.status?e(t.data.tags||[]):e([])})}},onAddTag:function(){h.files.jsonPost({url:"?module=tag&action=save&file_id="+t.file_id,data:{tags:i.val()}}),c()},onRemoveTag:function(){h.files.jsonPost({url:"?module=tag&action=save&file_id="+t.file_id+"&delete=1",data:{tags:i.val()}}),c()}}):(n=i.attr("id")+"_tagsinput",h("#"+n).addClass("f-readonly")),i.tagsInput(l),a&&h("#"+i.attr("id")+"_tag").bind("blur",function(){var t=h(this).val();t&&t!==o&&i.addTag(t)}),e.find("#f-file-tags_tag").val("").attr("placeholder",o)},File.prototype.initMarkControl=function(){const n=this,t=n.$file.find(".f-settings-colorbox .f-settings-item"),s=n.$file.find(".f-editable-header");n.marks.push("highlighted"),t.on("click",function(){n.$file.find(".f-settings-colorbox [data-icon]").addClass("hidden"),t.removeClass("selected");const e=h(this),i=e.data("mark");h.files.jsonPost({url:"?module=mark&action=save",data:{file_id:[n.file_id],mark:i},onSuccess:function(t){"ok"===t.status&&(e.addClass("selected").find("[data-icon]").removeClass("hidden"),s.length)&&s.removeClass(n.marks).addClass(i?"highlighted "+i:"")}})})},File.prototype.initHeaderRename=function(){var n=this,s=n.$file.find(".f-editable-header"),o=h.files.parseFileName(s.text());s.after('<a href="javascript:void(0);" class="button nobutton circle js-edit-title" style="font-size: 1rem;"><i class="fas fa-edit"></i></a>'),h.files.config.getMainContainer().find(".js-edit-title").on("click",function(){s.trigger("click")}),s.inlineEditable({minSize:{width:s.width()},maxSize:{width:600},size:{height:18},inputClass:"bold",afterMakeEditable:function(t){t.selection("setPos",{start:0,end:o.filename.length})},afterBackReadable:function(t,e){if(!e.changed)return!1;function i(){h.files.jsonPost({url:"?module=rename&action=file",data:{id:n.file_id,name:h(t).val()},onSuccess:function(t){"ok"===t.status&&t.data.file?h.files.controller.reloadPage():(s.text(e.old_text),t.errors&&t.errors.sync&&h.files.alertError(t.errors.sync.msg))}})}h.files.parseFileName(h(t).val()).ext!==o.ext?h.files.confirm(s.data("confirm-text"),function(){i()},function(){s.text(e.old_text)}):i()}})},File.prototype.initComments=function(){var i=this,t=i.$file,e=t.find("#f-add-comment-form"),n=e.find(".f-text"),s=(e.find(".f-button").on("click",function(){o()}),t.on("click",".f-comment-delete",function(){return a(h(this)),!1}),n.on("keydown",function(t){13!==t.keyCode||t.altKey||!t.ctrlKey||t.shiftKey||o()}),function(){h(window).off(".f-file-comment")}),o=(t="wa_before_reload_page.f-file-comment",h(window).off(t).on(t,function(t){0<h.trim(n.val()).length&&t.preventDefault()}),function(){h.files.clearValidateErrors(e),h.files.jsonPost({url:"?module=comment&action=save&file_id="+i.file_id,data:e.serialize(),onSuccess:function(t){t&&"ok"===t.status&&t.data.comment_id?(s(),h.files.controller.doRedispatch()):t&&"ok"!==t.status&&h.files.showValidateErrors(t.errors,e)}})}),a=function(t){var e=t.closest(".f-comment-item");t.html('<i class="icon16 loading"></i>'),h.get("?module=comment&action=delete&id="+e.data("id"),function(){i.$file.find(".f-comment-item").length<=1&&e.closest(".field").hide(),e.remove()})};h.files.onFormChange(e,function(){h.files.clearValidateErrors(e)})},File.prototype.initFrontUrl=function(){const t=this;var e=h("#f-frontend-url");e.length&&e.on("click",async function(){await h.wa.copyToClipboard(h(this).val()),h.wa.notify({class:"success",content:'<i class="fas fa-check-circle text-green custom-mr-8"></i> '+t.locale.copied,isCloseable:!1,timeout:2e3})})},File}(jQuery),FilesCatalog=(!function(d){d.files=d.files||{},d.files.controller=d.extend(d.files.controller||{},{hashes:[],init:function(t){var e,i=this,t=(i.options=d.extend(i.options,t||{}),void 0!==d.History&&(d.History.bind(d.files.controller.dispatch),d.History.unbind=function(i,n){n?d.History.handlers.specific[i]&&d.each(d.History.handlers.specific[i],function(t,e){if(e===n)return d.History.handlers.specific[i].splice(t,1),!1}):(n=i,d.each(d.History.handlers.generic,function(t,e){if(e===n)return d.History.handlers.generic.splice(t,1),!1}))}),window.location.hash);"#/"!==t&&t||(t=d.files.config.getLocaleStorage(),e=d.files.config.getContactId(),(t=t.get("files/settings/"+e)||{}).last_hash?(d.files.load.onError=function(){i.gotoDefaultPage(!0),delete d.files.load.onError},i.gotoPage(t.last_hash)):i.dispatch())},forceHash:function(t){t=d.files.controller.cleanHash(t),d.files.controller.currentHash!==t&&(d.files.controller.currentHash=t,d.wa.setHash(t))},backWithoutDispatch:function(t){var e;t&&d.History.bind(e=function(){d.History.unbind(e),t()}),this.skipDispatch=1,history.back()},redispatch:function(){this.currentHash=null,this.dispatch()},doRedispatch:function(t){this.currentHash=null,this.doDispatch(t)},skipDispatch:0,currentHash:null,cleanHash:function(t){for((t=void 0===t?window.location.hash.toString():t).length||(t=""+t);0<t.length&&"/"===t[t.length-1];)t=t.substr(0,t.length-1);return"#"!=(t+="/")[0]?t="#"+(t="/"!=t[0]?"/"+t:t):t[1]&&"/"!=t[1]&&(t="#/"+t.substr(1)),"#/"==t?"":(t||"").replace(/(^[^#]*#\/*|\/$)/g,"")},dispatch:function(t){return this!==d.files.controller?d.files.controller.dispatch(t):this.doDispatch({hash:t,beforeActionApply(){d("#f-core").find(".f-core-content").toggleClass("box contentbox","plugins"!==d.files.controller.currentAction)},afterActionApply:function(){d("html, body").animate({scrollTop:0},200)}})},doDispatch:function(t){var e=(t=d.isPlainObject(t)?t:{}).hash;if(0<d.files.controller.skipDispatch)return d.files.controller.skipDispatch--,!1;if(e=d.files.controller.cleanHash(e||void 0),d.files.controller.currentHash!=e){var i=d.files.controller.currentHash,n=(d.files.controller.currentHash=e,new d.Event("wa_before_dispatched"));if(d(window).trigger(n),n.isDefaultPrevented())return d.files.controller.currentHash=i,d.wa.setHash(i),!1;this.hashes.push(e);100<this.hashes.length&&this.hashes.slice(Math.round(50));var n=d.files.config.getLocaleStorage(),i=this.hashes[this.hashes.length-1],s=d.files.config.getContactId(),o=n.get("files/settings/"+s)||{};if(o.last_hash=i,n.set("files/settings/"+s,o),e)if((e=e.split("/"))[0]){for(var a="",r=e.length,l=0;l<e.length;l++){var c=e[l];if(!(l<2)){r=l;break}if(0!==l){var h=a+c.substr(0,1).toUpperCase()+c.substr(1);d.files.controller[h+"Action"]?a=h:r=l;break}a=c}i=e.slice(r);d.files.controller[a+"Action"]?(d.files.controller.currentAction=a,d.files.controller.currentActionAttr=i,"function"==typeof t.beforeActionApply&&t.beforeActionApply(),d.files.controller[a+"Action"].apply(d.files.controller,i),"function"==typeof t.afterActionApply&&t.afterActionApply()):console&&console.log("Invalid action name:",a+"Action")}else d.files.controller.defaultAction();else d.files.controller.defaultAction()}},getCurrentHash:function(t){var e=this.currentHash||"";return t=parseInt(t,10),isNaN(t)||t<=1?e:(e=e.split("/")).slice(0,t).join("/")},isAllListHash:function(){var t=this.getCurrentHash().split("/");return""===t[0]||"all"===t[0]},getIdOfTypeFromHash:function(t,e){if(!t||"string"!=typeof t)return null;e=e||"";t=new RegExp("^"+t+"\\/([\\d]+)$"),e=e.match(t),t=e&&parseInt(e[1],10);return"number"!=typeof t||isNaN(t)?null:t},getCurrentIdOfType:function(t){var e=this.getCurrentHash();return this.getIdOfTypeFromHash(t,e)},getCurrentFolderId:function(){return this.getCurrentIdOfType("folder")},getCurrentStorageId:function(){return this.getCurrentIdOfType("storage")},getCurrentFileId:function(){return this.getCurrentIdOfType("file")},getPreviousFolderId:function(){var t=this.hashes.length;return t<=1?null:(t=this.hashes[t-2],this.getIdOfTypeFromHash("folder",t))},getPreviousStorageId:function(){var t=this.hashes.length;return t<=1?null:(t=this.hashes[t-2],this.getIdOfTypeFromHash("storage",t))},load:function(t,e,i){d.files.load(t,function(){e&&e(),d.files.retina(),d.files.controller.afterLoadOnce&&d.files.controller.afterLoadOnce(),delete d.files.controller.afterLoadOnce},d.extend({},this.options,i))},reloadPage:function(t){var e=new d.Event("wa_before_reload_page");d(window).trigger(e),e.isDefaultPrevented()||(t?location.reload():this.redispatch())},gotoPage:function(t){t=this.cleanHash(t),this.getCurrentHash()===t?this.redispatch():location.hash="#/"+(t?t+"/":"")},replaceHashPrefix:function(t,e){t=d.files.controller.cleanHash(t),e=d.files.controller.cleanHash(e);t=t.split("/"),e=e.split("/"),t=e.join("/")+"/"+t.slice(e.length);return d.files.controller.cleanHash(t)},prepareHashForSomePage:function(t,e){return e||(e=this.getCurrentHash(),t=this.replaceHashPrefix(e,t)),t},gotoStoragePage:function(t,e){this.gotoPage(this.prepareHashForSomePage("storage/"+t+"/",e))},gotoFolderPage:function(t,e){this.gotoPage(this.prepareHashForSomePage("folder/"+t+"/",e))},gotoSearchPage:function(t,e){this.gotoPage(this.prepareHashForSomePage("search/"+t+"/",e))},gotoFilterPage:function(t,e){this.gotoPage(this.prepareHashForSomePage("filter/"+t+"/",e))},gotoSourcePage:function(t){this.gotoPage(this.prepareHashForSomePage("source/"+t+"/",!0))},gotoDefaultPage:function(t){t?this.gotoPage(""):this.gotoPage(this.prepareHashForSomePage("all",t))},gotoLastList:function(){for(var t=this.hashes.slice(0,-1),e="",i=t.length-1;0<=i;--i)if(this.isHashOfListPage(t[i])){e=t[i];break}this.gotoPage(e)},isHashOfListPage:function(t){t=(t=t||"").split("/");return 0<=["","all","storage","folder","favorite","trash","search","filter","tag"].indexOf(t[0])},defaultAction:function(){this.load("?module=backend&action=files")},allAction:function(t){this.load("?module=backend&action=files"+(t?"&"+t:""))},storageAction:function(t,e){this.load("?module=storage&action=files&id="+t+(e?"&"+e:""))},storageNewAction:function(){this.load("?module=storage&action=create")},sourceAction:function(t,e){this.load("?module=source&action=info&id="+t+(e?"&"+e:""))},sourceNewAction:function(){this.load("?module=source&action=create")},folderAction:function(t,e){this.load("?module=folder&action=files&id="+t+(e?"&"+e:""))},fileAction:function(t){this.load("?module=file&id="+t)},favoriteAction:function(t){this.load("?module=favorite&action=files"+(t?"&"+t:""))},trashAction:function(t){this.load("?module=trash&action=files"+(t?"&"+t:""))},searchAction:function(t,e){this.load("?module=search&action=files&hash="+t+(e?"&"+e:""))},filterAction:function(t,e){this.load("?module=filter&action=files&id="+t+(e?"&"+e:""))},filterNewAction:function(){this.load("?module=filter&action=create&acting_type=search")},tagAction:function(t,e){this.load("?module=tag&action=files&tags="+t+(e?"&"+e:""))},settingsAction:function(){this.load("?module=settings")},statisticsAction:function(i,e){function t(){var t=d.files.config.getStatisticsContainer().find(".f-statistics-menu"),e=(t.find(".selected").removeClass("selected"),t.find('a[href="#/statistics/'+i+'/"]'));e.length&&e.closest("li").addClass("selected"),-1!==t.find("a").map(function(){return d(this).attr("href").replace("#/statistics/","").replace("/","")}).toArray().indexOf(i)?(-1!==i.indexOf("_")&&(i=d.map(i.split("_"),function(t,e){return 0<e?d.files.ucfirst(t):t}).join("")),s("?module=statistics&action="+i)):d(".f-loading",d.files.config.getStatisticsContainer()).hide()}var n=this,s=function(t){n.load(t+(e?"&"+e:""),null,{container:d.files.config.getStatisticsContainer()})};d.files.config.getStatisticsContainer().length?t():n.load("?module=statistics",function(){t()})},pluginsAction:function(t){var e=d("#f-sidebar");e.find("li.selected").removeClass("selected"),e.find('a[href="#/plugins/"]:first').parent().addClass("selected"),d("#wa-plugins-content").length||this.load("?module=plugins")},crontasksAction:function(){this.load("?module=backend&action=crontasks")}})}(jQuery),!function(l){var e="is-hover";l.files=l.files||{},l.files.dragndrop={handlers:{},options:{},init:function(t){return this.options=t,this.initDragFiles(),this.initDropFiles(),this.initDropStorages(),this.initDropSharedFolders(),this.initDropTrash(),this.initDropFilters(),this},isFolder:function(t){return"folder"===t},isFile:function(t){return"file"===t},bind:function(t,e){return this.handlers[t]=e,this},trigger:function(t){if("function"==typeof this.handlers[t])return this.handlers[t].apply(this,Array.prototype.slice.call(arguments,1))},initDragFiles:function(){var t=l(".f-catalog-item",l.files.config.getFileList());function n(t){var e=l(".block.drop-target"),i=l(".f-drop-zone"),n="is-drop";t?(e.addClass("drag-active"),i.addClass(n)):(e.removeClass("drag-active"),i.removeClass(n))}t.find(".drag-handle").on("selectstart",function(){return!(document.onselectstart=function(){return!1})}),t.liveDraggable({opacity:.75,zIndex:9999,distance:5,appendTo:"body",cursor:"move",refreshPositions:!0,containment:[0,0,l(window).width(),{toString:function(){return l(document).height()}}],start:function(t,e){document.ondragstart=function(t){t.preventDefault()},e.helper.data("scrollTop",l(document).scrollTop()),l(document).on("scroll",l.files.dragndrop._scrolHelper),n(!0)},handle:".drag-handle",stop:function(t,e){document.ondragstart=null,document.onselectstart=null;var i=l(this);i.find("input:checked").length||i.removeClass("selected"),l("#hint-menu-block").hide().children().hide(),l(document).off("scroll",l.files.dragndrop._scrolHelper),n(!1)},helper:function(t,e){var i=1,n=l.files.config.getFileList().find(".f-catalog-item.selected");return n.length?i=-1!==n.index(this)?n.length:(l(this).addClass("selected"),n.length+1):l(this).addClass("selected"),'<div id="products-helper"><span class="indicator red">'+i+'</span><i class="icon10 no-bw" style="display:none;"></i></div>'},drag:function(t,e){t=t.originalEvent;e.position.left=t.pageX-20,e.position.top=t.pageY}})},initDropFiles:function(){l(".f-catalog-item",l.files.config.getFileList()).liveDroppable({disabled:!1,greedy:!0,tolerance:"pointer",drop:function(t,e){var i,e=e.draggable,n=l(this);return!!e.hasClass("f-catalog-item")&&!n.hasClass("selected")&&!!l.files.dragndrop.isFolder(n.data("type"))&&(e=n.data("id"),n=(i=l.files.config.getFileList().find(".f-catalog-item.selected")).map(function(){return l(this).data("id")}).toArray(),i.hide(),void l.files.config.getFileList().trigger("move_files",[{file_ids:n,folder_id:e,error:function(){i.show()}}]))}})},initDropStorages:function(){var t=l.files.config.getSidebar();l(".f-storage-list > li",t).liveDroppable({disabled:!1,greedy:!0,tolerance:"pointer",hoverClass:e,drop:function(t,e){var i,n,s=l(this).data("id");l.files.controller.getCurrentStorageId()!==s&&(n=(i=l.files.config.getFileList().find(".f-catalog-item.selected")).map(function(){return l(this).data("id")}).toArray(),l.files.config.getFileList().trigger("move_files",[{file_ids:n,storage_id:s,done:function(){i.hide()},error:function(){i.show()}}]))}})},initDropSharedFolders:function(){var t=l.files.config.getSidebar();l(".f-shared-folders > li",t).liveDroppable({disabled:!1,greedy:!0,tolerance:"pointer",hoverClass:e,drop:function(t,e){var i=l(this).data("id"),n=l.files.config.getFileList().find(".f-catalog-item.selected"),s=n.map(function(){return l(this).data("id")}).toArray();n.hide(),l.files.config.getFileList().trigger("move_files",[{file_ids:s,folder_id:i,error:function(){n.show()}}])}})},initDropTrash:function(){var t=l.files.config.getSidebar();l(".f-trash-files-wrapper",t).liveDroppable({disabled:!1,greedy:!0,tolerance:"pointer",hoverClass:e,drop:function(t,e){var i=l.files.config.getFileList().find(".f-catalog-item.selected").map(function(){return l(this).data("id")}).toArray();l.files.config.getFileList().trigger("move_files_to_trash",[{file_ids:i}])}})},initDropFilters:function(){var t=l.files.config.getSidebar();l(".f-filter-list-wrapper",t).liveDroppable({disabled:!1,greedy:!0,tolerance:"pointer",hoverClass:e,drop:function(){var t=l.files.config.getFileList().find(".f-catalog-item.selected").map(function(){return l(this).data("id")}).toArray();l.files.config.getFileList().trigger("make_filter",[{file_ids:t}]),l(this).removeClass(e)}})},_scrolHelper:function(t){var e=l("#products-helper"),i=e.data("scrollTop"),n=l(document).scrollTop(),i=i?n-i:50;e.css("top",e.position().top+i+"px"),e.data("scrollTop",n)},_extDragActivate:function(t,e,i){var n,s,o,a,r=i+"-last";e.hasClass("last")?(n=t.pageX,t=t.pageY,s=e.width(),o=e.height(),a=e.offset(),"thumbs"==l.files.dragndrop.options.view?n>a.left+.5*s&&n<=a.left+s?(e.removeClass(i).addClass(r),l.files.dragndrop._shiftToLeft(e)):n>a.left&&n<=a.left+.5*s?(e.removeClass(r).addClass(i),l.files.dragndrop._shiftToRight(e)):l.files.dragndrop._shiftAtPlace(e):"table"==l.files.dragndrop.options.view&&(t>a.top+.5*o?e.removeClass(i).addClass(r):t>a.top&&e.removeClass(r).addClass(i)),(t<a.top||t>a.top+o||n<a.left||n>a.left+s)&&e.removeClass(i).removeClass(r)):e.addClass("drag-active")},_bindExtDragActivate:function(e,i){l(document).bind("mousemove.ext_drag_activate",function(t){l.files.dragndrop._extDragActivate(t,e,i)})},_unbindExtDragActivate:function(){l(document).unbind("mousemove.ext_drag_activate")},_activatePhotoListItem:function(){var t=l(this),e=l.files.dragndrop.trigger("is_product_sortable"),i=e?"drag-active":"drag-active-disabled";e&&"thumbs"==l.files.dragndrop.options.view&&l.files.dragndrop._shiftToRight(t),t.hasClass("last")?l.files.dragndrop._bindExtDragActivate(t,i):t.addClass(i)},_unactivatePhotoListItem:function(){var t=l(this),e=l.files.dragndrop.trigger("is_product_sortable"),i=e?"drag-active":"drag-active-disabled",n=i+"-last";t.hasClass("last")&&l.files.dragndrop._unbindExtDragActivate(),t.removeClass(i+" "+n),e&&"thumbs"==l.files.dragndrop.options.view&&l.files.dragndrop._shiftAtPlace(t)},_shiftToLeft:function(t){var e,i;"left"!==t.data("shifted")&&((i=t.find(".p-wrapper")).length||(e=t.children(),(i=l("<div class='p-wrapper' style='position:relative;'></div>").appendTo(t)).append(e)),i.stop().animate({left:-15},200),t.data("shifted","left"))},_shiftToRight:function(t){var e,i;"right"!==t.data("shifted")&&((i=t.find(".p-wrapper")).length||(e=t.children(),(i=l("<div class='p-wrapper' style='position:relative;'></div>").appendTo(t)).append(e)),i.stop().animate({left:15},200),t.data("shifted","right"))},_shiftAtPlace:function(t){var e,i;t.data("shifted")&&((e=t.find(".p-wrapper")).length&&(i=e.children(),e.stop().css({left:0}),t.append(i),e.remove()),t.data("shifted",""))}}}(jQuery),function(d){return(FilesCatalog=function(t){var e=this;e.$catalog=t.$catalog,e.$operationMenu=t.$operationMenu,e.$catalogWrapper=e.$catalog.closest(".f-catalog-content"),e.$catalogCheckAll=e.$catalog.find(".f-catalog-header .check-all-files"),e.$menuCheckAll=e.$operationMenu.find(".f-checkbox"),e.storage={shown_class:"is-shown",selected_class:"selected"},e.storage_id=t.storage_id||!1,e.folder_id=t.folder_id||!1,e.total_count=e.getFiles().length,e.is_fixed_menu_init=!1,e.$lastSelectedFile=!1,e.selectedFilesCount=0,e.selectedFilesTypeCount={file:0,folder:0},e.initCatalog()}).prototype.initCatalog=function(){this.bindEvents(),this.highlightFiles()},FilesCatalog.prototype.bindEvents=function(){var s=this,t=s.$catalog,e=s.$catalogCheckAll,i=s.$menuCheckAll;t.on("click",".f-catalog-item .f-select-file",function(t){t.stopPropagation(),s.onSelectFile(t,d(this))}),t.on("click",".f-catalog-item",function(t){for(var e,i=d(t.target),n=!1;!i.is(".f-catalog-item");){if(i.is("a")){n=!0;break}i=i.parent()}n||(e=d(this).find(".f-select-file")).is(":disabled")||(e.prop("checked",!e.is(":checked")),s.onSelectFile(t,e))}),e.on("click",function(){s.onSelectAll()}),t.on("selectAll",function(){s.onSelectAll(!0)}),t.on("unSelectAll",function(){s.onSelectAll(!1)}),i.on("click",function(){s.selectedFilesCount=0,s.selectedFilesTypeCount={file:0,folder:0},e.click()}),d(".f-in-sync").on("click",function(){return alert($_("Sync is in process. No changes available until synchronization finish.")),!1}),d(".js-copy-link:not(.f-in-sync)").on("click",function(){return s.showDialog("?module=copy",{is_copy:!0}),!1}),d(".js-move-link:not(.f-in-sync)").on("click",function(){return s.showDialog("?module=move",{is_move:!0}),!1}),d(".js-move-to-trash-link:not(.f-in-sync)").on("click",function(){return s.showDialog("?module=delete",{is_trash:!0}),!1}),d(".js-restore-link:not(.f-in-sync)").on("click",function(){return s.showDialog("?module=move&restore=1",{is_restore:!0}),!1}),d(".js-mark-link").on("click",function(){return s.showDialog("?module=mark",{is_mark:!0}),!1}),d(".js-delete-link:not(.f-in-sync)").on("click",function(){return s.showDialog("?module=delete&permanently=1",{is_delete:!0}),!1}),d(".js-rename-link:not(.f-in-sync)").on("click",function(){return s.showDialog("?module=rename&id=",{is_rename:!0}),!1}),d(".js-send-link").on("click",function(){return s.showDialog("?module=send&from=fileinfo",{is_send:!0}),!0}),d("#f-trash-clear").on("click",function(){var t=d(this).data("confirm-text");d.files.confirm(t,function(){d.files.jsonPost({url:"?module=trash&action=clear",onSuccess:function(){d.files.refreshSidebar(),d.files.controller.reloadPage()}})})}),d(".js-tags-link").on("click",function(){return s.showDialog("?module=tag",{is_tag:!0}),!1}),d("#f-create-folder-link:not(.f-in-sync)").on("click",function(){var t="?module=folder&action=create";s.storage_id&&(t+="&storage_id="+s.storage_id),s.folder_id&&(t+="&folder_id="+s.folder_id),d.files.loadDialog(t)}),d("#f-share-link").on("click",function(){s.folder_id&&d.files.loadDialog("?module=share&file_id="+s.folder_id)}),d("#f-public-link").on("click",function(){s.folder_id&&d.files.loadDialog("?module=share&public_link=1&file_id="+s.folder_id)}),this.$catalog.on("click",".js-show-copyprocess-info",function(){d.files.alertInfo(d(this).closest(".js-copytask-info-wrapper").find(".js-copytask-info").html())})},FilesCatalog.prototype.getFiles=function(){return this.$catalog.find(".f-catalog-item")},FilesCatalog.prototype.highlightFiles=function(){var e,t=this.storage_id,i=d.files.config.getLocaleStorage();0<t&&((i=i.get("files/all_counters_update_times")||{}).storage=i.storage||{},e=parseInt(i.storage[t],10),this.getFiles().each(function(){var t=d(this);0<t.data("update-time")-e&&t.addClass("highlighted")}))},FilesCatalog.prototype.onSelectFile=function(t,e){var s,o=this,t=t.shiftKey,a=e.prop("checked"),r=e.closest(".f-catalog-item"),l=!!o.$lastSelectedFile.length&&o.$lastSelectedFile;a&&t&&l?(e=o.getFiles(),s=!1,e.each(function(){var t=d(this),e=t.hasClass("selected"),i=t[0]==r[0],n=t[0]==l[0];if(i||n){if(s=!s,e||(o.selectFile(a,t),o.$lastSelectedFile=t),!s)return!1}else s&&!e&&t.find(".f-select-file").click()})):o.selectFile(a,r),o.$lastSelectedFile=!!a&&r},FilesCatalog.prototype.selectFile=function(t,e){var i=this,n=i.$operationMenu,s=i.$catalogCheckAll,o=i.$menuCheckAll,a=n.find(".f-operation-link.is-rename"),r=n.find(".f-operation-link.is-send"),l=e.data("type");t?(i.selectedFilesCount++,i.selectedFilesTypeCount[l]++,e.addClass("selected"),e.hasClass("highlighted")&&e.removeClass("highlighted").addClass("f-used-to-be-highlighted")):(0<i.selectedFilesCount&&i.selectedFilesCount--,0<i.selectedFilesTypeCount[l]&&i.selectedFilesTypeCount[l]--,e.removeClass("selected"),e.hasClass("f-used-to-be-highlighted")&&e.removeClass("f-used-to-be-highlighted").addClass("highlighted")),0==i.selectedFilesCount&&n.removeClass(i.storage.shown_class),1==i.selectedFilesCount&&(n.addClass(i.storage.shown_class),a.closest("li").show()),1<i.selectedFilesCount&&a.closest("li").hide(),0<i.selectedFilesTypeCount.folder?r.closest("li").hide():r.closest("li").show(),n.find(".f-operation-link .f-count").text("("+i.selectedFilesCount+")"),i.selectedFilesCount==i.total_count?(s.prop({checked:!0,indeterminate:!1}),o.prop({checked:!0,indeterminate:!1})):i.selectedFilesCount<i.total_count&&0<i.selectedFilesCount?(s.prop({checked:!1,indeterminate:!0}),o.prop({checked:!1,indeterminate:!0})):(s.prop({checked:!1,indeterminate:!1}),o.prop({checked:!1,indeterminate:!1})),i.is_fixed_menu_init||(i.initFixedMenu(),i.is_fixed_menu_init=!0)},FilesCatalog.prototype.onSelectAll=function(e){const i=this,t=i.getFiles(),n=i.$catalogCheckAll;e=void 0!==e?e:n.prop("checked"),t.each(function(){var t=d(this).find(".f-select-file");t.prop("checked",e),i.selectFile(e,t)})},FilesCatalog.prototype.showDialog=function(t,e){var i=this.$catalog.find(".f-select-file:checked"),n="";(e=e||{}).is_rename||!1?n=i.first().val():i.each(function(){n+="&file_id[]="+d(this).val()}),e=t+n,d.files.loadDialog(e)},FilesCatalog.prototype.initFixedMenu=function(){var i=this,n=i.$catalogWrapper,s=i.$operationMenu,o=d(window),t=s.offset(),e="is-fixed",a="absolute"==s.css("position"),r=!1,l={top:t.top,left:t.left,width:s.outerWidth(),height:s.outerHeight()};function c(){r=!0,a||n.css("padding-top",l.height),s.addClass(e)}function h(){r=!1,a||n.removeAttr("style"),s.removeAttr("style").removeClass(e)}o.on("scroll resize",function t(){var e=!(d.contains(document,s[0])&&s.hasClass(i.storage.shown_class));if(e)return i.is_fixed_menu_init=!1,o.off("scroll resize",t),!1;e=o.scrollTop()>l.top;!r&&e?c():r&&!e&&h();r&&s.width(n.width())}),o.trigger("scroll")},FilesCatalog}(jQuery)),LongActionProcess=function(){function e(){for(;0<p.length;){var t=p.shift();t&&clearTimeout(t)}}function t(t){if(!t.url)throw new Error("Url is required");h=t.url,f=t.step_delay||f,u=t.rest_delay||u,g=t.post_data||g,i=t.onCleanup,n=t.onReady,s=t.onProgress,o=t.onError,a=t.onWarning,r=t.onStart,l=t.onStop,c=t.onAlways}var i,n,s,o,a,r,l,c,h="",d="",f=500,u=750,p=[],g={},m=function(){var t=$.extend(!0,{},g);t.processId=d,t.cleanup=1,$.post(h,t,function(t){i&&i(t)}).always(function(){e()})},v=function(t){t=t||f;t=setTimeout(function(){var t=$.extend(!0,{},g);t.processId=d,$.post(h,t,function(t){t?t.ready?(n&&n(t),m()):t.error?o&&o(t):t.progress?(s&&s(t),v()):t.warning?(a&&a(t),v()):v(u):v(u),c&&c(t)},"json").error(function(){v(u)})},t);p.push(t)};return $.extend(t.prototype,{start:function(){r&&r();var t=$.extend(!0,{},g);$.post(h,t,function(t){t&&t.processId?(d=t.processId,v(100),v(200)):t&&t.error?o&&o(t):o&&o("Server error")},"json").error(function(){o&&o("Server error")})},stop:function(){l&&l(),e()}}),t}();
//# sourceMappingURL=files.min.js.map
